---
title: 'クライアント管理の Windows コンピューターの構成項目を作成する '
titleSuffix: Configuration Manager
description: カスタム Windows デスクトップおよびサーバーの構成項目を使用して Windows コンピューターとサーバーの設定を管理します。
ms.date: 11/18/2016
ms.prod: configuration-manager
ms.technology: configmgr-compliance
ms.topic: conceptual
ms.assetid: 1eb2fcaf-acac-4388-9b31-6cccafacaabe
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: fbdb2ecdd0057b52586a7fa19e22cafa0319b039
ms.sourcegitcommit: 48098f9fb2f447672bf36d50c9f58a3d26acb9ed
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/14/2018
ms.locfileid: "53422234"
---
# <a name="how-to-create-custom-configuration-items-for-windows-desktop-and-server-computers-managed-with-the-system-center-configuration-manager-client"></a>System Center Configuration Manager クライアントを使用して管理されている Windows デスクトップおよびサーバー コンピューターのカスタム構成項目を作成する方法

*適用対象:System Center Configuration Manager (Current Branch)*


System Center Configuration Manager **カスタム Windows デスクトップおよびサーバー**の構成項目を使用して、Configuration Manager クライアントで管理されている Windows コンピューターおよびサーバーの設定を管理します。  

## <a name="start-the-create-configuration-item-wizard"></a>構成項目の作成ウィザードを開始する

1.  Configuration Manager コンソールで、**[資産とコンプライアンス]** > **[コンプライアンス設定]** > **[構成項目]** の順にクリックします。  

3.  **[ホーム]** タブの **[作成]** グループで、**[構成項目の作成]** をクリックします。  

4.  **構成項目の作成ウィザード** の **[全般]** ページで、構成項目の名前と、必要に応じて説明を入力します。  

5.  **[作成する構成項目の種類の指定]** で、 **[Windows デスクトップおよびサーバー (カスタム)]** を選択します。  

    > [!TIP]  
    >  アプリケーションの有無を確認する検出方法の設定を指定するには、 **[この構成ファイルにアプリケーションの設定が含まれる]** を選択します。  

6.  Configuration Manager コンソールで構成項目を検索およびフィルター処理するのに役立つカテゴリを作成して割り当てる場合は、**[カテゴリ]** をクリックします。  

## <a name="provide-detection-method-information"></a>検出方法の情報の指定  
 構成項目の検出方法に関する情報を指定するには、次の手順に従います。  

> [!NOTE]  
>  これは、ウィザードの **[全般]** ページで **[この構成項目にアプリケーション設定を含める]** を選択した場合にのみ、適用されます。  

 Configuration Manager における検出方法には、アプリケーションがコンピューターにインストールされているかどうかを検出するために使用される規則が含まれます。 この検出は、コンプライアンスに関連する構成項目の評価の前に実行されます。 アプリケーションがインストールされているかどうかを検出するため、そのアプリケーションの Windows インストーラー ファイルの存在を検出します。または、**[常にアプリケーションがインストールされていると仮定する]** を選択して、アプリケーションがインストールされているかどうかに関係なく、コンプライアンスに関する構成項目の評価が行われるようにします。  

 これらの手順を使用して、System Center Configuration Manager で検出方法を構成します。  

### <a name="to-detect-an-application-installation-by-using-the-windows-installer-file"></a>Windows インストーラー ファイルを使用してアプリケーションのインストールを検出するには  

1.  **構成項目の作成ウィザード** の **[検出方法]** ページで、**[Windows インストーラーの検出を使用する]** チェック ボックスを選択します。  

2.  **[開く]** をクリックして、検出する Windows インストーラー (.msi) ファイルを参照してから、**[開く]** をクリックします。  

3.  **[バージョン]** ボックスには、選択した Windows インストーラー ファイルのバージョン番号が自動的に入力されます。 このボックスに表示された値が正しくない場合は新しいバージョン番号を入力することができます。  

4.  コンピューターのユーザー プロファイルごとに検出を実行する場合は、 **[このアプリケーションは 1 人以上のユーザー用にインストールする]** チェック ボックスをオンにします。  

### <a name="to-detect-a-specific-application-and-deployment-type"></a>特定のアプリケーションおよび展開の種類を検出するには  

1.  **構成項目の作成ウィザード** の **[検出方法]** ページで、 **[特定のアプリケーションと展開の種類を検出する]** チェック ボックスをオンにして、 **[選択]** をクリックします。  

2.  **[アプリケーションの指定]** ダイアログ ボックスで、検出するアプリケーションおよび関連付けられている展開の種類を選択します。  

### <a name="to-detect-an-application-installation-by-using-a-custom-script"></a>カスタム スクリプトを使用してアプリケーションのインストールを検出するには  

1.  **構成項目の作成ウィザード** の **[検出方法]** ページで、**[カスタム スクリプトを使用する]** チェック ボックスを選択します。  

2.  一覧で、開くスクリプトの言語を選択します。 次のスクリプトから選択できます。  

    -   **VBScript**  

    -   **JScript**  

    -   **PowerShell**  

3.  **[開く]** をクリックして、使用するスクリプトを参照してから、**[開く]** をクリックします。  

##  <a name="configure-settings"></a>設定の構成  
 構成項目の設定を構成するには、次の手順に従います。  

 設定は、クライアント デバイスでコンプライアンス対応の評価に使用されるビジネス条件または技術条件を表わします。 新しい設定を構成することも、参照コンピューターの既存の設定を参照することもできます。  

1. **構成項目の作成ウィザード** の **[設定]** ページで、**[新規]** をクリックします。  

2. **[設定の作成]** ダイアログ ボックスの **[全般]** タブで、次の情報を指定します。  

   - **名前:** 設定の一意の名前を入力します。 最大 256 文字を使用できます。  

   - **説明:** 設定の説明を入力します。 最大 256 文字を使用できます。  

   - **設定の種類:** 一覧で、この設定を使用する次の設定の種類のいずれかを選択して、構成します。  

     - **Active Directory クエリ**  

        **[LDAP プレフィックス]** - クライアント コンピューターでコンプライアンス対応を評価するための Active Directory ドメイン サービス クエリの有効なプレフィックスを指定します。 いずれかを使用する **LDAP://** のまたは **GC://** をグローバル カタログの検索を実行する.  

        **[識別名 (DN)]** - クライアント コンピューターでコンプライアンス対応を評価する Active Directory Domain Services オブジェクトの識別名を指定します。  

        たとえば、corp.contoso.com ドメインの John Smith という名前のユーザーに関連する値を評価する場合は、次のように入力します。  

       - **[検索フィルター]** - クライアント コンピューターでコンプライアンス対応を評価するための Active Directory ドメイン サービス クエリの結果を絞り込む、オプションの LDAP フィルターを指定します。  

          クエリからすべての結果を返すには、「**(objectclass=\*)**」と入力します。  

       - **[検索範囲]** - Active Directory ドメイン サービスにおける検索範囲を指定します。次の中から選択できます。  

         -   **[基本]** - 指定されているオブジェクトのみを対象としてクエリを実行します。  

         -   **1 つのレベル** - このバージョンの Configuration Managerでは使用されていないオプションです。  

         -   **[サブツリー]** - ディレクトリー内で指定されているオブジェクトとそのサブツリー一式を対象としてクエリを実行します。  

       - **[プロパティ]** - クライアント コンピューターでコンプライアンス対応を評価するために使用する Active Directory ドメイン サービス オブジェクトのプロパティを指定します。  

          たとえば、次の Active Directory プロパティのクエリを実行する **badPwdCount**, 、ユーザーがパスワードを正しく入力回数の合計を格納している、入力 **badPwdCount** このフィールドにします。  

       - **クエリ** -内のエントリから構築されたクエリが表示されます **LDAP プレフィックス**, 、 **識別名 (DN)**, 、 **検索フィルター** (選択した場合のみ)、および **プロパティ**, 、クライアント コンピュータで対応を評価するために使用します。  

         詳細については、LDAP クエリを構築する、Windows Server のマニュアルを参照してください。  

     - **アセンブリ**  

        この設定の種類では次を構成します。  

       - **アセンブリ名:** 検索対象のアセンブリ オブジェクトの名前を指定します。 名前は、同じ種類の他のアセンブリ オブジェクトと同じにすることはできず、グローバル アセンブリ キャッシュ (GAC) に登録されている必要があります。 アセンブリ名は 256 文字以内で指定します。  

         アセンブリは、アプリケーション間で共有可能なコードの断片です。 アセンブリのファイル拡張子は .dll または .exe です。 グローバル アセンブリ キャッシュ (GAC) は、クライアント コンピューター上の *%systemroot%\Assembly* という名前のフォルダーであり、すべての共有アセンブリが保存されます。  

     - **ファイル システム**  

       - **[種類]** - 一覧で、**[ファイル ]** と **[フォルダー]** のどちらを検索するか選択します。  

       - **[パス]** - 指定したファルまたはフォルダーのクライアント コンピューター上のパスを指定します。 パスには、システム環境変数と *%USERPROFILE%* 環境変数を指定できます。  

         > [!NOTE]  
         >  *%USERPROFILE%* 環境変数を **[パス]** ボックスまたは **[ファイル名またはフォルダー名]** ボックスで使用すると、クライアント コンピューターのすべてのユーザー プロファイルが検索されます。そのため、ファイルまたはフォルダーのインスタンスが複数見つかることがあります。  
         >   
         >  指定されたパスに対するアクセス権がコンプライアンス設定に含まれていない場合、検出エラーが発生します。 また、検索対象のファイルが使用中である場合も、検出エラーが発生します。  

       - **[ファイル名またはフォルダー名]** - 検索対象のファイル オブジェクトまたはフォルダー オブジェクトの名前を指定します。 ファイル名またはフォルダー名には、システム環境変数と *%USERPROFILE%* 環境変数を指定できます。 ファイル名にワイルドカードとして * と ? を 使用することもできます。  

         > [!NOTE]  
         >  ファイル名またはフォルダー名を指定するときにワイルドカードを使用すると、それらの組み合わせによっては検索結果の数が非常に多くなり、それに伴って、検索結果が Configuration Manager に報告される際にクライアント コンピューターで大量のリソースが使用され、大量のネットワーク トラフィックが発生する可能性があります。  

       - **[サブフォルダーを含める]** - このオプションは、指定したパス内のサブフォルダーも検索する場合に有効にします。  

       - **このファイルまたはフォルダーは、64 ビット アプリケーションに関連付けられて** - 64 ビットのファイルの場所のみを有効な場合 (など *%programfiles%*) は、64 ビット コンピューターでチェックします。 このオプションが有効になっていない場合は、32 ビット ( *%ProgramFiles(x86)%* など) と 64 ビットの両方の場所がチェックされます。  

         > [!NOTE]  
         >  同じ 64 ビット コンピューターで 32 ビット システム ファイルの場所と 64 ビット システム ファイルの場所に同じファイルまたはフォルダーが存在する場合、グローバル条件では複数のファイルが検出されます。  

         設定の種類の **[ファイル システム]** の場合、**[パス]** ボックスにネットワーク共有フォルダーへの UNC パスを指定することはできません。  

     - **IIS メタベース**  

       -   **[メタベース パス]** - インターネット インフォメーション サービス (IIS) メタベースへの有効なパスを指定します。  

       -   **[プロパティ ID]** - IIS メタベース設定の数値プロパティを指定します。  

     - **レジストリ キー**  

       -   **[ハイブ]** - 一覧で、検索場所となるレジストリ ハイブを選択します。  

       -   **[キー]** - 検索対象のレジストリ キーの名前を指定します。 「 *キー\サブキー*」の形式を使用します。  

       -   **[このレジストリ キーを 64 ビット アプリケーションに関連付ける]** - 64 ビット版の Windows を実行するクライアントで 32 ビット レジストリ キーだけでなく 64 ビット レジストリ キーも検索するかどうかを指定します。  

           > [!NOTE]  
           >  64 ビット コンピューターの 64 ビット および 32 ビット システム ファイルの場所に同じレジストリ キーが存在する場合は、グローバル条件によって両方のレジストリ キーが検知されます。  

     - **レジストリ値**  

       - **[ハイブ]** - 一覧で、検索場所となるレジストリ ハイブを選択します。  

       - **[キー]** - 検索対象のレジストリ キーの名前を指定します。 「 *キー\サブキー*」の形式を使用します。  

       - **値** – 指定されたレジストリ キー内に含まれる必要がありますのある値を指定します。  

       - **[このレジストリ キーを 64 ビット アプリケーションに関連付ける]** - 64 ビット版の Windows を実行するクライアントで 32 ビット レジストリ キーだけでなく 64 ビット レジストリ キーも検索するかどうかを指定します。  

         > [!NOTE]  
         >  64 ビット コンピューターの 64 ビット および 32 ビット システム ファイルの場所に同じレジストリ キーが存在する場合は、グローバル条件によって両方のレジストリ キーが検知されます。  

         **[参照]** をクリックして、コンピューターまたはリモート コンピューターのレジストリの場所を参照することもできます。 リモート コンピューターを参照するには、リモート コンピューターで管理者権限が必要し、リモート コンピューターでは、リモート レジストリ サービスが実行されている必要があります。  

     - **スクリプト**  

       -   **探索スクリプト** - **[追加]** をクリックして入力するか、使用するスクリプトを参照します。 Windows PowerShell、VBScript、または Microsoft JScript のスクリプトが使用できます。  

       -   **ログオンしたユーザーの資格情報を使用してスクリプトを実行する** - このオプションをオンにすると、ログオンしているユーザーの認証を使って、クライアント コンピューターでスクリプトが実行されます。  

           > [!NOTE]  
           >  スクリプトによって返された値は、グローバル条件のコンプライアンスを評価するのに使用されます。 たとえば、VBScript を使用している場合、コマンド **[WScript.Echo Result]** を使用して、 *Result* 変数値をグローバル条件に返すことができます。  

     - **SQL クエリ**  

       -   **SQL Serverインスタンス** – 既定のインスタンス、すべてのインスタンス、または特定のデータベースのインスタンス名のどれで SQL クエリを実行するかを選択します。  

           > [!NOTE]  
           >  インスタンス名は、SQL Server のローカル インスタンスを参照する必要があります。 クラスター化された SQL Server インスタンスを参照するには、スクリプト設定を使用する必要があります。  

       -   **データベース** -SQL クエリを実行する対象となる Microsoft SQL Server データベースの名前を指定します。  

       -   **列** -グローバル条件のコンプライアンス評価に使用される TRANSACT-SQL ステートメントによって返される列名を指定します。  

       -   **TRANSACT-SQL ステートメント** – グローバル条件を使用する完全な SQL クエリを指定します。 また、**[開く]** をクリックして、既存の SQL クエリを開くこともできます。  

           > [!IMPORTANT]  
           >  SQL クエリ設定はデータベースを変更する SQL コマンドに対応していません。 データベースから情報を読み込む SQL コマンドのみ使用できます。  

     - **WQL クエリ**  

       -   **名前空間** -クライアント コンピューターのコンプライアンスを評価する WQL クエリを作成に使用される Windows Management Instrumentation (WMI) 名前空間を指定します。 既定値は、Root\cimv2 です。  

       -   **クラス** -クライアント コンピューターのコンプライアンスを評価する WQL クエリの構築に使用される WMI クラスを指定します。  

       -   **プロパティ** -クライアント コンピューターのコンプライアンスを評価する WQL クエリの構築に使用される WMI プロパティを指定します。  

       -   **WQL クエリの WHERE 句** - **WQL クエリの WHERE 句** 項目を使用して、クライアント コンピューター上の指定された名前空間、クラス、およびプロパティに適用される WHERE 句を指定できます。  

     - **XPath クエリ**  

       - **パス** - コンプライアンスの評価で使用されるクライアント コンピューターの .xml ファイルへのパスを指定します。 Configuration Manager では、パス名にすべての Windows システム環境変数と *%USERPROFILE%* ユーザー変数の使用がサポートされています。  

       - **XML ファイル名** -クライアント コンピューターの対応評価に使用される XML クエリを含むファイル名を指定します。  

       - **サブフォルダーも含める** – 指定したパスの下にあるサブフォルダーも検索する場合は、このオプションをオンにします。  

       - **このファイルは 64 ビット アプリケーションに関連付けられている** - 64 ビット バージョンの Windows を実行している Configuration Manager クライアントで、32 ビット システム ファイルの場所 (*%windir%* \System32) に加えて64 ビット システム ファイルの場所 (*%windir%* \Syswow64) も検索する必要があるかどうかを選択します。  

       - **XPath クエリ** -有効な完全 XML パス言語 (XPath) クエリを使用してクライアント コンピュータで対応を評価するを指定します。  

       - **名前空間** - XPath クエリの実行中に使用する名前空間およびプレフィックスを特定する **[XML 名前空間]** ダイアログ ボックスを開きます。  

         暗号化された .xml ファイルを探索しようとすると、コンプライアンス設定でファイルを検索しますが、XPath クエリは結果を示さず、エラーも生成されません。  

         XPath クエリが有効でない場合は、設定はクライアント コンピューターでコンプライアンス非対応と評価されます。  

   - **データ型:** 設定の評価に使用する前に、一覧から条件の戻り値となるデータの形式を選択します。 **[データの種類]** 一覧は、設定の種類によっては表示されません。  

     > [!NOTE]  
     >  **[浮動小数点]** データの種類は、小数点第 3 位までをサポートしています。  

3. **[設定の種類]** 一覧の下でこの設定についての追加情報を構成します。 構成できる項目は、選択した設定の種類によって異なります。  

   > [!NOTE]  
   >  **[ファイル システム]**、**[レジストリ キー]**、**[レジストリ値]** の設定を作成する場合は、**[参照]** をクリックして参照コンピューターの値で設定を構成できます。 レジストリ キーまたは値をリモート コンピューターで参照するには、リモート コンピューターのリモート レジストリ サービスが有効になっている必要があります。  

4. **[OK]** をクリックして設定を保存し、**[設定の作成]** ダイアログ ボックスを閉じます。  

##  <a name="configure-compliance-rules"></a>コンプライアンス規則の構成  
 構成項目のコンプライアンス規則を構成するには、次の手順に従います。  

 コンプライアンス規則は、構成項目のコンプライアンスを定義する条件を指定します。 設定に対してコンプライアンス評価が行われる前に、少なくとも 1 つのコンプライアンス規則を設ける必要があります。 WMI、レジストリ、およびスクリプトの設定により、コンプライアンス非対応となった値の修復ができます。 新しい規則を作成、または構成項目の既存の設定を参照して規則を選択することができます。  

### <a name="to-create-a-compliance-rule"></a>コンプライアンス規則を作成するには  

1.  **構成項目の作成ウィザード** の **[コンプライアンスの規則]** ページで、**[次へ]** をクリックします。  

2.  [規則の作成] **** ダイアログ ボックスで、次の情報を入力します。  

    -   **名前:** コンプライアンス規則の名前を入力します。  

    -   **説明:** コンプライアンス規則の説明を入力します。  

    -   **選択された設定:****[参照]** をクリックして、**[設定の選択]** ダイアログ ボックスを開きます。 規則を定義する設定を選択するか、または **[新しい設定]** をクリックします。 完了したら、**[選択]** をクリックします。  

        > [!NOTE]  
        >  **[プロパティ]** をクリックすると、現在選択されている設定についての情報も表示できます。  

    -   **ルールの種類:** 使用するコンプライアンス規則の種類を選択します。  

        -   **値** 時間を指定する構成項目によって返される値を比較するルールを作成します。  

        -   **存在** またはが見つかった回数を超えるクライアント デバイス上に存在するかどうかによって、設定を評価する規則を作成します。  

    -   [値] **** の種類の規則では、次の情報を指定します:  

        -   **設定は、次の規則に従う必要があります** – 演算子と、選択した設定に準拠するために評価される値を選択します。 使用できる演算子は次のとおりです。  

            |演算子|説明|  
            |--------------|----------------------|  
            |次の値と等しい|詳細情報なし|  
            |次の値に等しくない|詳細情報なし|  
            |次の値より大きい|詳細情報なし|  
            |次の値より小さい|詳細情報なし|  
            |次の値の間|詳細情報なし|  
            |次の値以上|詳細情報なし|  
            |次の値以下|詳細情報なし|  
            |次のいずれか|テキストボックスで 1 行ごとに 1 つのエントリを指定します。|  
            |次のいずれでもない|テキストボックスで 1 行ごとに 1 つのエントリを指定します。|  

        -   **サポートされている場合は対応していない規則を修復する** - このオプションを選択すると、Configuration Manager がコンプライアンス非対応の規則を自動的に修復します。 Configuration Manager は次の規則の種類を自動的に修復できます。  

            -   **レジストリ値** – が準拠していない場合は、レジストリ値は修復が存在しない場合に作成したとします。  

            -   **スクリプト** (を修復スクリプトを自動的に実行するには)。  

            -   **WQL クエリ**  

            > [!IMPORTANT]  
            >  コンプライアンス非対応の規則は、演算子が **[等しい]** に設定されている場合にのみ修復されます。  

        -   **この設定のインスタンスが見つからない場合は、コンプライアンス非対応を報告** – クライアント コンピューターでこの設定が見つからない場合に、構成項目がコンプライアンス非対応を報告します。  

        -   **レポートするコンプライアンス非対応の重要度:** コンプライアンス規則に従っていないときに (Configuration Manager レポートで) レポートをする重要度のレベルを指定します。 利用可能な重要度のレベルは、次のとおりです。  

            -   **なし**: このコンプライアンス規則を満たしていないコンピューターは、何も報告しません。  

            -   **情報**: このコンプライアンス規則を満たしていないコンピューターは、**情報**というレベルで非対応を報告します。  

            -   **警告**: このコンプライアンス規則を満たしていないコンピューターは、**警告**というレベルで非対応を報告します。  

            -   **重大**: このコンプライアンス規則を満たしていないコンピューターは、**重大**というレベルで非対応を報告します。  

            -   **重大 (イベント)**: このコンプライアンス規則を満たしていないコンピューターは、**重大**というレベルで非対応を報告します。 重要度のレベルは、アプリケーションのイベント ログでも Windows のイベントとしてログが登録されます。  

        -   [存在] **** の種類の規則では、次の情報を指定します:  

            > [!NOTE]  
            >  表示されるオプションは、規則を構成する設定の種類によって異なります。  

            -   **この設定はクライアント デバイスに存在しなければならない**  

            -   **この設定はクライアント デバイスに存在してはならない**  

            -   **この設定は次の回数出現する:**  

        -   **レポートするコンプライアンス非対応の重要度:** コンプライアンス規則に従っていないときに (Configuration Manager レポートで) レポートをする重要度のレベルを指定します。 利用可能な重要度のレベルは、次のとおりです。  

            -   **なし**: このコンプライアンス規則を満たしていないコンピューターは、何も報告しません。  

            -   **情報**: このコンプライアンス規則を満たしていないコンピューターは、**情報**というレベルで非対応を報告します。  

            -   **警告**: このコンプライアンス規則を満たしていないコンピューターは、**警告**というレベルで非対応を報告します。  

            -   **重大**: このコンプライアンス規則を満たしていないコンピューターは、**重大**というレベルで非対応を報告します。  

            -   **重大 (イベント)**: このコンプライアンス規則を満たしていないコンピューターは、**重大**というレベルで非対応を報告します。 重要度のレベルは、アプリケーションのイベント ログでも Windows のイベントとしてログが登録されます。  

3.  **[OK]** をクリックして **[規則の作成]** ダイアログ ボックスを閉じます。  

##  <a name="specify-supported-platforms"></a>サポートされているプラットフォームの指定  
 対応プラットフォームは、構成項目がコンプライアンスの評価をされるオペレーティング システムです。  

**構成項目の作成ウィザード** の **[サポートされているプラットフォーム]** ページで、一覧から、コンプライアンスを評価する構成項目が存在する Windows バージョンを選択するか、 **[すべて選択]** をクリックします。  

## <a name="complete-the-wizard"></a>ウィザードを完了する  
 ウィザードの **[概要]** ページで、実行される操作を確認し、[次へ] をクリックします。 新しい構成項目は、**[資産とコンプライアンス]** ワークスペースの **[構成項目]** ノードに表示されます。  
