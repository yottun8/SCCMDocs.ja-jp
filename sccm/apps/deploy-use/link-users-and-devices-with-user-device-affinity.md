---
title: ユーザーとデバイスのアフィニティへのユーザーとデバイスの関連付け
titleSuffix: Configuration Manager
description: ユーザーとデバイスのアフィニティにユーザーとデバイスを関連付けて、ユーザーに関連付けられたすべてのデバイスにアプリを自動的に展開します。
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.technology: configmgr-app
ms.topic: conceptual
ms.assetid: 5b30b0d5-722d-4d4b-9ed7-5a43de315461
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 5343f10fe1e8a7b799454801c764a43619488014
ms.sourcegitcommit: 48098f9fb2f447672bf36d50c9f58a3d26acb9ed
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/14/2018
ms.locfileid: "53421741"
---
# <a name="link-users-and-devices-with-user-device-affinity-in-system-center-configuration-manager"></a>System Center Configuration Manager でのユーザーとデバイスのアフィニティへのユーザーとデバイスの関連付け

*適用対象:System Center Configuration Manager (Current Branch)*

System Center Configuration Manager (Configuration Manager) のユーザーとデバイスのアフィニティにより、1 人のユーザーが 1 台以上のデバイスに関連付けられます。 これにより、ユーザーのデバイス名を把握しなくても、アプリケーションをユーザーに展開することができます。 この場合、アプリケーションを各ユーザーのデバイスに展開するのではなく、アプリケーションをユーザーに展開します。 ユーザーとデバイスのアフィニティによって、そのユーザーに関連付けられているすべてのデバイスにアプリケーションが自動的にインストールされます。  

 ユーザーが毎日の仕事で使用するデバイスを、通常は、プライマリ デバイスとして定義できます。 ユーザーとデバイスの間にアフィニティを作成すると、アプリの展開の選択肢が増えます。 たとえば、ユーザーが Microsoft Visio を必要とする場合は、Windows インストーラーの展開を使用して、Microsoft Visio をユーザーのプライマリ デバイスにインストールすることができます。 ただし、プライマリ デバイスでないデバイスには、Visio を仮想アプリケーションとして展開してもかまいません。 また、ユーザーとデバイスのアフィニティを使用すれば、ユーザーがサインインしていないときにユーザーのデバイスにソフトウェアを事前に展開できます。このため、ユーザーがログオンしたときには、アプリは既にインストールされ、実行準備ができています。  

 コンピューターのユーザーとデバイスのアフィニティ情報を管理する必要があります。 Configuration Manager では、登録されているモバイル デバイスのユーザーとデバイスのアフィニティが自動的に管理されます。  

## <a name="manually-set-up-user-device-affinity"></a>ユーザーとデバイスのアフィニティの手動セットアップ  

1.  Configuration Manager コンソールで、**[資産とコンプライアンス]** > **[デバイス]** を選択します。  

3.  リストからデバイスを選択します。 **[ホーム]** タブの **[デバイス]** グループで、**[プライマリ ユーザーの編集]** を選びます。  

4.  **[プライマリ ユーザーの編集]** ダイアログ ボックスで、選択したデバイスのプライマリ ユーザーとして追加するユーザーを検索して選びます。 **[追加]** を選びます。  

    > [!NOTE]  
    > **[プライマリ ユーザー]** リストに、このデバイスのプライマリ ユーザーであるユーザーと、ユーザー デバイス関係の割り当て方法が表示されます。  

## <a name="set-up-primary-devices-for-a-user"></a>ユーザーのプライマリ デバイスをセットアップする  

1.  Configuration Manager コンソールで、**[資産とコンプライアンス]** > **[ユーザー]** を選びます。  

3.  リストからユーザーを選択します。 次に、**[デバイス]** タブの **[プライマリ デバイスの編集]** を選びます。  

4.  **[プライマリ デバイスの編集]** ダイアログ ボックスで、選択したユーザーにプライマリ デバイスとして追加するデバイスを検索して選びます。 **[追加]** を選びます。  

    > [!NOTE]  
    > **[プライマリ ユーザー]** リストに、このユーザーのプライマリ デバイスとしてセットアップされているデバイスと、各ユーザー デバイス関係の割り当て方法が表示されます。  

## <a name="automatically-create-user-device-affinities-windows-pcs-only"></a>ユーザーとデバイスのアフィニティの自動作成 (Windows PC のみ)  
 Configuration Manager によって、Windows イベント ログからユーザーのログオンに関するデータが読み取られます。 ユーザーとデバイスのアフィニティを自動的に作成するには、クライアント コンピューターのローカル セキュリティ ポリシーで次の 2 つのオプションを有効にして、ログオン イベントを Windows イベント ログに保存する必要があります。  

- **アカウント ログオン イベントの監査**  
- **ログオン イベントの監査**  

  これらの設定を構成するには、Windows グループ ポリシーを使います。  

> [!IMPORTANT]  
> エラーによって Windows イベント ログのエントリ数が多数になると、新しいイベント ログが作成される可能性があります。 この場合、Configuration Manager から既存のログオン イベントを使用できなくなることがあります。  
>   
> Windows XP で **[アカウント ログオン イベントの監査]** と **[ログオン イベントの監査]** の設定を有効にするときは注意してください。 既定では、アイテム保持ポリシーは 7 日で、多くの場合、セキュリティ イベント ログは、これらのイベントでいっぱいになります。 標準ユーザーは、イベント ログがいっぱいになると、ログオンできなくなります。 この問題を回避するには、セキュリティ イベント ログの **[保存方法]** ポリシーの値を、**[必要に応じてイベントを上書きする]** に設定します。 ユーザーとデバイスのアフィニティ用のデータを十分にするには、さらに、セキュリティ イベント ログの最大サイズ ポリシーを 5 ～ 20 MB などの適切な値に設定します。  

### <a name="set-up-the-site-to-automatically-create-user-device-affinities"></a>ユーザーとデバイスのアフィニティを自動作成するためにサイトをセットアップする  

1.  Configuration Manager コンソールで、**[管理]** > **[クライアント設定]** の順に選択します。  

2.  既定のクライアント設定を変更するには、**[既定のクライアント設定]** を選択してから、**[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選びします。 カスタムのクライアント エージェント設定を作成するには、**[クライアント設定]** ノードを選択してから、**[ホーム]** タブの **[作成]** グループで、**[カスタム クライアント デバイス設定の作成]** を選択します。  

    > [!NOTE]  
    > 規定のクライアント設定を変更すると、階層内のすべてのコンピューターに展開されます。 クライアント設定の構成方法の詳細については、「[System Center Configuration Manager でクライアント設定を構成する方法](../../core/clients/deploy/configure-client-settings.md)」を参照してください。  

3.  **[ユーザーとデバイスのアフィニティ]** で次のように設定します。  

    -   **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (分)]**:  ユーザーとデバイスのアフィニティが作成されるまでのデバイス使用分数を設定します。  

    -   **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (日)]**:  使用状況に基づいたアフィニティのしきい値を測定する期間 (日) を設定します。  

    -   **[使用状況データに基づいてユーザーとデバイスのアフィニティを自動構成する]**:  サイトに自動的にユーザーとデバイスのアフィニティを作成させるには、ドロップダウン リストから **[True]** を選択します。 **[False]** を選択した場合は、すべてのユーザーとデバイスのアフィニティ割り当てを承認する必要があります。  

    > [!TIP]  
    > **例:** **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (分)]** を **60** 分に設定し、**[ユーザーとデバイスのアフィニティ使用状況のしきい値 (日)]** を **5** 日に設定している場合、ユーザーとデバイスのアフィニティを自動的に作成するには、ユーザーは 5 日間に 60 分以上デバイスを使用する必要があります。  

ユーザーとデバイスのアフィニティが自動的に作成された後は、Configuration Manager がユーザーとデバイスのアフィニティ使用状況のしきい値の監視を続けます。 デバイスに対するユーザーのアクティビティが設定したしきい値を下回ると、ユーザーとデバイスのアフィニティは削除されます。 **[ユーザーとデバイスのアフィニティ使用状況のしきい値 (日)]** を少なくとも **7** 日に設定して、週末などユーザーがログインしていない間に自動的に構成されたユーザーとデバイスのアフィニティが失われないようにします。  

## <a name="import-user-device-affinities-from-a-file"></a>ファイルからのユーザーとデバイスのアフィニティのインポート  
 一度に多くの関係を作成するには、複数のユーザーとデバイスのアフィニティの詳細を含むファイルをインポートします。 この手順の場合、対象のデバイスが検出されていて、Configuration Manager データベースにリソースとして存在している必要があります。そうでない場合は、この手順は失敗します。  

1.  Configuration Manager コンソールで、**[資産とコンプライアンス]** > **[ユーザー]** または **[デバイス]** の順に選びます。  

2.  **[ホーム]** タブの **[作成]** グループで **[ユーザーとデバイスのアフィニティのインポート]** を選びます。  

3.  ユーザーとデバイスのアフィニティのインポート ウィザードの **[マッピングの選択]** ページで、次の情報を設定します。  

    -   **[ファイル名]**:  間にアフィニティを作成するユーザーとデバイスの一覧を含むコンマ区切り (CSV) ファイルを指定します。 このファイルでは、ユーザーとデバイスの各ペアはコンマで区切られ、それぞれのペアが別々の行になければなりません。 <*ドメイン*>&#92;<*ユーザー名*>,<*デバイスの NetBIOS 名*> の形式を使います。  

    -   **[このファイルに参考用の列見出しを付ける]**:  .csv ファイルの先頭行にヘッダーがある場合は、このオプションを選ぶと、インポート時にヘッダー行が無視されます。  

4.  1 行に 3 項目以上が含まれているファイルをインポートする場合は、**[列]** と **[割り当て]** を使用して、ユーザーとデバイスを表す列とインポート中に無視する列を指定することができます。  

5.  **[次へ]** をクリックして、ユーザーとデバイスのアフィニティのインポート ウィザードを完了します。  

## <a name="let-users-create-their-own-device-affinities"></a>ユーザーが自分とデバイスのアフィニティを作成できるようにする  
 次の手順では、ユーザーがソフトウェア センター アプリで自分のユーザーとデバイスのアフィニティを作成するように設定できます。  

### <a name="set-up-the-site-to-allow-user-created-user-device-affinity-requests"></a>ユーザーが作成したユーザーとデバイスのアフィニティ要求を許可するようにサイトをセットアップする  

1.  Configuration Manager コンソールで、**[管理]** > **[クライアント設定]** の順に選択します。  

2.  既定のクライアント設定を変更するには、**[既定のクライアント設定]** を選択してから、**[ホーム]** タブの **[プロパティ]** グループで、**[プロパティ]** を選びします。 カスタムのクライアント エージェント設定を作成するには、**[クライアント設定]** ノードを選択してから、**[ホーム]** タブの **[作成]** グループで、**[カスタム クライアント ユーザー設定の作成]** を選択します。  

    > [!NOTE]  
    > 規定のクライアント設定を変更すると、階層内のすべてのコンピューターに展開されます。 クライアント設定の構成については、「[Configure client settings](../../core/clients/deploy/configure-client-settings.md)」 (クライアント設定の構成) を参照してください。  

3.  クライアント設定 **[ユーザーとデバイスのアフィニティ]** を選択し、 **[ユーザーがプライマリ デバイスを定義できるようにする]** ボックスの一覧で **[True]** を選択します。  

### <a name="set-up-a-user-device-affinity"></a>ユーザーとデバイスのアフィニティをセットアップする  

1.  [アプリケーション カタログ] で **[マイ システム]** を選ぶ。  

2.  **[このコンピューターを日常の仕事で使用します]** オプションを選びます。  

## <a name="manage-user-device-affinity-requests-from-users"></a>ユーザーからのユーザーとデバイスのアフィニティ要求の管理  
 クライアント設定の **[使用状況データに基づいてユーザーとデバイスのアフィニティを自動構成する]** が **[False]** に設定されている場合は、すべてのユーザーとデバイスのアフィニティ割り当てを承認する必要があります。  

### <a name="approve-or-reject-a-user-device-affinity-request"></a>ユーザーとデバイスのアフィニティ要求を承認または拒否する  

1.  Configuration Manager コンソールで、**[資産とコンプライアンス]** を選択します。  

2.  **[資産とコンプライアンス]** ワークスペースで、アフィニティ要求を管理するユーザーまたはデバイスを選択します。  

3.  **[ホーム]** タブの **[コレクション]** グループで、**[アフィニティ要求の管理]** を選びます。  

4.  **[ユーザーとデバイスのアフィニティ要求の管理]** ダイアログ ボックスで、アフィニティ要求を選択し、**[承認]** または **[拒否]** を選びます。  
