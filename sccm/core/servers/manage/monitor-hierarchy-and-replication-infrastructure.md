---
title: "レプリケーションを監視する | Microsoft Docs"
description: "Configuration Manager コンソールの [監視] ワークスペースを使用して、Configuration Manager のインフラストラクチャと操作を監視します。"
ms.custom: na
ms.date: 10/06/2016
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 3fab4d67-8d2a-45ce-8b06-471280102cf6
caps.latest.revision: "11"
caps.handback.revision: "0"
author: Brenduns
ms.author: brenduns
manager: angrobe
ms.openlocfilehash: 132803a1aa9aad5c5462686bd656688418e47d07
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2017
---
# <a name="monitor-hierarchy-and-replication-infrastructure-in-system-center-configuration-manager"></a>System Center Configuration Manager での階層とレプリケーション インフラストラクチャの監視

*適用対象: System Center Configuration Manager (Current Branch)*

System Center Configuration Manager のインフラストラクチャと操作を監視するには、Configuration Manager コンソールの **[監視]** ワークスペースを使用します。  

> [!NOTE]  
>  その場所に対する例外は移行です。それは、 **[管理]** ワークスペースの **[移行]** ノードで直接監視します。 詳細については、[System Center Configuration Manager に移行するための操作](../../../core/migration/operations-for-migration.md)を参照してください。  

 監視には、Configuration Manager コンソールだけでなく、Configuration Manager レポートや、Configuration Manager コンポーネントの Configuration Manager ログ ファイルも使用できます。 レポートの詳細については、「[System Center Configuration Manager のレポート](../../../core/servers/manage/reporting.md)」を参照してください。 ログ ファイルの詳細については、「[System Center Configuration Manager のログ ファイル](../../../core/plan-design/hierarchy/log-files.md)」を参照してください。  

 サイトを監視するときは、問題発生の兆候があるかどうかに注意します。 たとえば、  

-   サイト サーバーとサイト システムにあるファイルのバックログ  

-   エラーまたは問題を示すステータス メッセージ  

-   サイト間の通信障害  

-   サーバーのシステム イベント ログのエラー メッセージと警告メッセージ  

-   Microsoft SQL Server エラー ログのエラー メッセージと警告メッセージ  

-   長期間レポートを送信していないサイトまたはクライアント  

-   SQL Server データベースの応答の遅延  

-   ハードウェア障害の兆候  

サイト障害のリスクを最小限に抑えるため、監視タスクによって問題の兆候が見つかった場合は、できるだけ速やかに問題の原因を調査して修復してください。  



##  <a name="BKMK_MonintorMgmtTasks"></a> Configuration Manager の一般的な管理タスクの監視  
 Configuration Manager コンソールには監視機能が組み込まれています。 ソフトウェア更新プログラム、電源管理、およびコンテンツの展開に関連するものを含む多くのタスクを階層全体で監視できます。  

 Configuration Manager の一般的なタスクを監視するには、次の情報を使用します。  

 **アラート**  
   「[System Center Configuration Manager のアラートとステータス システムの使用](../../../core/servers/manage/use-alerts-and-the-status-system.md#BKMK_MonitorAlerts) 」の「 [アラートの監視](../../../core/servers/manage/use-alerts-and-the-status-system.md)」を参照してください。  

 **コンプライアンス設定**  
   「[System Center Configuration Manager でコンプライアンス設定を監視する方法](../../../compliance/deploy-use/monitor-compliance-settings.md)」を参照してください。  

 **コンテンツ展開**  
   コンテンツ監視に関する一般的な情報については、「[System Center Configuration Manager のコンテンツ インフラストラクチャとコンテンツの管理](../../../core/servers/deploy/configure/manage-content-and-content-infrastructure.md)」を参照してください。  

特定の種類のコンテンツの展開を監視するには:
-   アプリケーションを監視するには、「[System Center Configuration Manager でアプリケーションを監視する](/sccm/apps/deploy-use/monitor-applications-from-the-console)」を参照してください。  

-   パッケージとプログラムを監視するには、「[System Center Configuration Manager のパッケージとプログラム](../../../apps/deploy-use/packages-and-programs.md)」の「パッケージとプログラムを管理する方法」を参照してください。  

**Endpoint Protection**  
   「[System Center Configuration Manager で Endpoint Protection を監視する方法](../../../protect/deploy-use/monitor-endpoint-protection.md)」を参照してください。  

**電源管理の監視**  
 「[System Center Configuration Manager で電源管理を監視して計画する方法](../../../core/clients/manage/power/monitor-and-plan-for-power-management.md)」を参照してください。  

**ソフトウェア使用状況測定の監視**  
「[System Center Configuration Manager のソフトウェア使用状況測定でアプリの使用状況を監視する](../../../apps/deploy-use/monitor-app-usage-with-software-metering.md)」を参照してください。  

**ソフトウェア更新プログラムの監視**  
 「[System Center Configuration Manager でのソフトウェア更新プログラムの監視](../../../sum/deploy-use/monitor-software-updates.md)」を参照してください。  


##  <a name="BKMK_MonitorInfrastructure"></a> Configuration Manager の階層インフラストラクチャの監視  
Configuration Manager の階層のステータスや操作を監視するには、いくつか方法があります。 階層内のサイトのシステム ステータスの確認、サイトの階層図または地図からのサイト間レプリケーションの監視、データベース レプリケーションを行うサイト間のレプリケーション リンクの監視、レプリケーション リンク アナライザー ツールを使用したレプリケーションの問題の修復を行えます。  

###  <a name="BKMK_SH_Node"></a> サイト階層ノードについて  
**[監視]** ワークスペースの **[サイト階層]** ノードには、Configuration Manager の階層とサイト間のリンクの概要が表示されます。 次の 2 つのビューがあります。  

-   **階層図**:重要な情報のみを表示するように簡略化されたトポロジ マップとして階層が表示されます。  

-   **地図**:このビューでは、構成するサイトの場所を示す地図にサイトが表示されます。  

各サイト、サイト間レプリケーション リンク、および外的な要因との関係 (地理的な場所など) の正常性を監視するには、[ **サイト階層** ]ノードを使用します。  

サイトの状態およびサイト間リンクの状態は、グローバル データではなくサイト データとしてレプリケートされるため、Configuration Manager コンソールを子プライマリ サイトに接続すると、他のプライマリ サイトやその子セカンダリ サイトのサイトの状態またはリンクの状態は表示されません。 たとえば、複数のプライマリ サイトがある階層で、Configuration Manager コンソールをあるプライマリ サイトに接続すると、子セカンダリ サイト、そのプライマリ サイト、および中央管理サイトのステータスは表示できますが、階層内の中央管理サイトの下にある他のノードのステータスは表示できません。  

 サイト階層を表示する方法を制御するには、[ **設定の構成** ] コマンドを使用します。 あるサイトに Configuration Manager コンソールを接続したときに設定した **[サイト階層]** ノードの構成は、他のすべてのサイトにレプリケートされます。  

#### <a name="hierarchy-diagram"></a>階層図  
 階層図は、サイトをトポロジ マップで表示します。 このビューでは、サイトを選択して、そのサイトのステータス メッセージの概要の表示、ドリルダウンによるステータス メッセージの表示、サイトの [ **プロパティ** ] ダイアログ ボックスへのアクセスを行うことができます。  

 また、サイト間のレプリケーション リンクまたはサイトの上にマウス ポインターを置くと、そのオブジェクトのステータスの概要が表示されます。 レプリケーション リンクはグローバルにレプリケートされないため、複数のプライマリ サイトがある階層で、すべてのサイトの間のレプリケーション リンクの詳細を表示するには、Configuration Manager コンソールを中央管理サイトに接続する必要があります。  

 次のオプションを使用すると、階層図が変更されます。  

-   [ **グループ** ]:プライマリ サイトおよびセカンダリ サイトの数を構成できます。これにより、複数のサイトが単一のオブジェクトに結合されている階層図の表示が変更されます。 複数のサイトを単一のオブジェクトに結合すると、サイトの合計数、ステータス メッセージのロールアップの概要、およびサイトのステータスを表示できます。 グループの構成は地図には影響しません。  

-   [ **お気に入りサイト** ]:個々のサイトをお気に入りサイトとして指定できます。 階層図内の星形のアイコンはお気に入りサイトを示します。 お気に入りサイトは、グループを使用する場合に他のサイトと結合されず、常に個別に表示されます。  

#### <a name="geographical-view"></a>地図  
 地図は、各サイトの場所を地図上に表示します。 場所を指定して構成したサイトのみが表示されます。 このビューでサイトを選択すると、親サイトまたは子サイトへのレプリケーション リンクが表示されます。 階層図ビューとは異なり、このビューにサイトのステータス メッセージまたはレプリケーション リンクの詳細を表示することはできません。  

> [!NOTE]  
>  地図を使用するには、Configuration Manager コンソールを接続するコンピューターに Internet Explorer がインストールされていて、HTTP プロトコルを使用して Bing Maps にアクセスできる必要があります。  

次のオプションを使用すると、地図が変更されます。  

-   [ **サイトの場所** ]:サイトごとに地理的な場所を指定できます。 この場所に、住所を指定したり、都市名などの地名を指定したり、緯度や経度を使って指定することもできます。 たとえば、ワシントン州レドモンドの緯度と経度を使用する場合、 **N 47 40 26.3572 W 122 7 17.4432** をサイトの場所として指定します。 緯度や経度の度、分、または秒を示す記号を指定する必要はありません。 Configuration Manager では、Bing Maps を使って地図上に場所が表示されます。 これにより、地理的な場所の関係に従って階層を表示するオプションが提供され、特定のサイトまたはサイト間レプリケーションに影響する可能性がある地理的な問題を把握できます。  

     場所を指定する場合、[ **場所** ] ボックスを使用して、階層内の特定のサイトを検索できます。 サイトを選択した状態で、 **[場所]** 列に都市名または住所で場所を入力します。 Configuration Manager は Bing Maps を使用して場所を見つけます。  

###  <a name="BKMK_MonitorRepLinksAndStatuss"></a> データベース レプリケーション リンクとレプリケーション ステータスを監視する方法  
 **[監視]** ワークスペースの **[サイト階層]** ノードで概要にアクセスできるほか、 **[監視]** ワークスペースの **[データベースのレプリケーション]** ノードを使用して、データベース レプリケーションの詳細を監視することもできます。 **[データベースのレプリケーション]** で、サイト間のレプリケーション リンクのステータス、および Configuration Manager コンソールが接続されているサイトのレプリケーション グループの初期化の詳細とレプリケーションの詳細を監視できます。  

> [!TIP]  
>  **[データベースのレプリケーション]** ノードは **[管理]** ワークスペースの **[階層の構成]** ノードにも表示されますが、この場所からデータベース レプリケーション リンクのレプリケーション ステータスを表示することはできません。  

####  <a name="BKMK_MonitorReplicationLinks"></a> レプリケーション リンク ステータス  
サイト間のデータベース レプリケーションでは、レプリケーション グループと呼ばれる、複数の情報セットがレプリケートされます。 レプリケーション グループごとに、異なる優先順位でレプリケートされます。 既定では、レプリケーション グループに含めるデータとレプリケーションの頻度は変更できません。  

 レプリケーション リンクがアクティブで、ステータスが "失敗" や "低速化" になっていない場合、すべてのレプリケーション グループが遅れることなくレプリケートされます。 所定の時間内にレプリケートできなかったレプリケーション グループがある場合は、リンクが低速化していると表示されます。 低速化したリンクは引き続き機能しますが、リンクを監視してアクティブな状態に戻ったのを確認するか、リンクを調査してさらに低速になったりレプリケーションが失敗したりすることがないようにする必要があります。  

 レプリケーション リンクごとに、レプリケーション グループのレプリケートが失敗したときに、リンクのステータスが "低速化" または "失敗" に設定される前にレプリケートを再試行する回数を指定できます。 1 つのレプリケーション グループを残して、他のすべてのレプリケーション グループでレプリケートが成功した場合でも、この 1 つのレプリケーション グループが指定の試行回数でレプリケーションを完了できなかったため、リンクのステータスは "低速化" または "失敗" に設定されます。 レプリケーションのしきい値については、「[System Center Configuration Manager におけるサイト間のデータ転送](../../../core/servers/manage/data-transfers-between-sites.md)」の「[データベース レプリケーションのしきい値](../../../core/servers/manage/data-transfers-between-sites.md#BKMK_DBRepThresholds)」セクションを参照してください。  

 レプリケーション リンクでさらに調査が必要となる可能性がある場合は、そのステータスを把握するときに、次の表の情報を参考にしてください。  

|リンクの説明|説明|  
|----------------------|----------------------|  
|**リンクはアクティブです**|問題は検出されていません。リンク間の通信は最新の状態です。|  
|**リンクが低速化しています**|レプリケーションは機能していますが、少なくとも 1 つのレプリケーション オブジェクトまたはレプリケーション グループに遅延が生じています。 この状態にあるリンクを監視して、リンクが失敗する兆候がないかどうか、リンクの両方のサイトの情報を確認します。<br /><br /> レプリケートされたデータを受信するサイトがデータベースにデータを迅速にコミットできない場合にも、リンクにステータス "低速化" が表示されることがあります。 これは、大容量のデータをレプリケートすると発生する可能性があります。 たとえば、多数のコンピューターにソフトウェア更新プログラムを展開する場合、レプリケートするデータの量のために、リンク上で親サイトでの処理に時間がかかることがあります。 親サイトでの処理の遅延のために、親サイトでデータのバックログを正常に処理できるようになるまで、リンクのステータスが "低速化" に設定されることがあります。|  
|**リンクは正しく機能しませんでした**|レプリケーションが機能していません。 何も措置を講じなくても、レプリケーション リンクが回復する可能性があります。 レプリケーション リンク アナライザーを使用して、このリンクのレプリケーションを調査して修復できます。<br /><br /> また、このステータスが、レプリケーション リンクで親サイトと子サイト間の物理ネットワークに問題があることを示している可能性もあります。|  

 親サイトで新しいサービス パックへのアップグレードが進行中である場合、子サイトからリンク ステータスを表示すると、リンク ステータスは "アクティブ" と表示されます。 アップグレード後に、子サイトを親サイトと同じサービス パックにするまで、親サイトからリンク ステータスを表示すると "アクティブ" と表示され、子サイトからリンク ステータスを表示すると "構成中" と表示されます。  

####  <a name="BKMK_MonitorReplicationStatus"></a> レプリケーション ステータス  
 **[監視]** ワークスペースの **[データベースのレプリケーション]** ノードを使用して、レプリケーション リンクのレプリケーションのステータスを表示したり、レプリケーション リンク上の各サイトのサイト データベースについての詳細を表示したりできます。 レプリケーション グループの詳細を表示することもできます。 詳細を表示するには、レプリケーション リンクを選択してから、表示するレプリケーション ステータスの適切なタブを選択します。 レプリケーション ステータスの各種タブの詳細は次のとおりです。  

 **概要**  
 リンク上の 2 つのサイト間のサイト データとグローバル データのレプリケーションの概要を表示します。  

 [ **関連トラフィック データの履歴情報の表示** ] をクリックすると、レプリケーション リンクでレプリケーションに使用されたネットワーク帯域幅の詳細も表示できます。  

 **親サイト**  
 レプリケーション リンク上の親サイトのデータベースの詳細を表示します。次のものが含まれます。  

-   SQL Server のファイアウォール ポート  

-   ディスクの空き領域  

-   データベース ファイルの場所  

-   証明書  

**子サイト**  
 レプリケーション リンク上の子サイトのデータベースの詳細を表示します。次のものが含まれます。  

-   SQL Server のファイアウォール ポート  

-   ディスクの空き領域  

-   データベース ファイルの場所  

-   証明書  

**初期化の詳細**    
 レプリケーション リンクでレプリケートされる、レプリケーション グループの初期化ステータスを表示します。 この情報を使用すると、レプリケーション データの初期化が進行中のときや失敗したときに、それを特定できます。  

 また、この情報を使用すると、サイトが相互運用性モードになっているときにも、それを特定できます。 相互運用性モードは、子サイトで親サイトと同じバージョンの Configuration Manager を実行していない場合に発生します。  

**レプリケーションの詳細**    
 リンクでレプリケートされる、各レプリケーション グループのレプリケーション ステータスを表示します。 この情報を使用すると、特定のデータのレプリケーションに問題や遅延がないかどうかを特定したり、このリンクのデータベース レプリケーションの適切なしきい値を判断したりできます。 データベース レプリケーションのしきい値については、「[System Center Configuration Manager におけるサイト間のデータ転送](../../../core/servers/manage/data-transfers-between-sites.md)」の「[データベース レプリケーションのしきい値](../../../core/servers/manage/data-transfers-between-sites.md#BKMK_DBRepThresholds)」セクションを参照してください。  

> [!TIP]  
>  サイト データのレプリケーション グループは、子サイトからのみ親サイトに送信されます。 グローバル データのレプリケーション グループは、双方向でレプリケートされます。  

###  <a name="BKMK_RLA"></a> レプリケーション リンク アナライザーについて  
 Configuration Manager には、レプリケーションの問題の分析と修復に使用する**レプリケーション リンク アナライザー**が含まれています。 レプリケーション リンク アナライザーを使用すると、レプリケーションが失敗した場合や、レプリケーションが停止したがまだ "失敗" と報告されていない場合に、レプリケーション リンクの不具合を分析して修復できます。 レプリケーション リンク アナライザーを使用すると、Configuration Manager 階層内の次のコンピューター間のレプリケーションの問題を修復できます (レプリケーション エラーが発生した方向は関係ありません)。  

-   サイト サーバーとサイト データベース サーバー  

-   あるサイトのサイト データベース サーバーと別のサイトのサイト データベース コンピューター (サイト間レプリケーション)  

レプリケーション リンク アナライザーは、Configuration Manager コンソールまたはコマンド プロンプトで実行することができます。  

-   Configuration Manager コンソールで実行するには、**[監視]** ワークスペースで **[データベースのレプリケーション]** ノードをクリックし、分析するレプリケーション リンクを選択します。次に、**[ホーム]** タブの **[データベースのレプリケーション]** グループで **[レプリケーション リンク アナライザー]**を選択します。  

-   コマンド プロンプトで実行する場合は、次のコマンドを入力します。**%path%\Microsoft Configuration Manager\AdminConsole\bin\Microsoft.ConfigurationManager.ReplicationLinkAnalyzer.Wizard.exe &lt;ソース サイト サーバーの FQDN\> &lt;リンク先のサイト サーバーの FQDN\>**  

レプリケーション リンク アナライザーを実行すると、一連の診断規則とチェックに従って問題が検出されます。 このツールを実行すると、見つかった問題を表示できます。 問題の解決方法がわかっている場合は、その方法も表示されます。 レプリケーション リンク アナライザーによって自動的に問題を修復可能な場合は、そのオプションが示されます。 レプリケーション リンク アナライザーの実行が終了すると、このツールを実行したユーザーのデスクトップに、次の XML ベースのレポートとログ ファイルが保存されます。  

-   ReplicationAnalysis.xml  

-   ReplicationLinkAnalysis.log  

レプリケーション リンク アナライザーを実行すると、一部の問題の修復中は次のサービスが停止され、修復が完了すると、これらのサービスが再開されます。  

-   SMS_SITE_COMPONENT_MANAGER  

-   SMS_EXECUTIVE  

レプリケーション リンク アナライザーによって修復を完了できない場合は、サイト サーバーが確認されて、これらのサービスが停止されているときには、これらのサービスが再開されます。  

このログ ファイルには、ツールのインターフェイスには表示されない、詳しい問題の調査や修復処理に関する情報が記録されています。  

**レプリケーション リンク アナライザーを使用するための前提条件**  

-   レプリケーション リンク アナライザーを実行するアカウントには、レプリケーション リンクに関係する各コンピューターのローカル管理者権限が必要です。 このアカウントには、役割に基づいた管理の特定のセキュリティ ロールは必要ありません。 したがって、**[データベースのレプリケーション]** ノードにアクセスできる管理ユーザーは、Configuration Manager コンソールでこのツールを実行できます。また、各コンピューターの十分な権限を持っているシステム管理者は、コマンド プロンプトでこのツールを実行できます。  

-   レプリケーション リンク アナライザーを実行するアカウントには、レプリケーション リンクに関係する各 SQL Server データベースの sysadmin 権限が必要です。  

**レプリケーション リンク アナライザーの既知の問題**  

-   System Center Configuration Manager バージョン 1511 では、レプリケーション リンク アナライザーで、System Center 2012 Configuration Manager からアップグレードされたプライマリ サイトに関する SQL Server Service Broker 証明書エラーが発生します。 その原因は、レプリケーション リンク アナライザーがまだ更新されていないバージョン 1511 で導入された証明書の名前が変更されたことです。 これらのエラーは無視してもかまいません。  

###  <a name="BKMK_ProcsforMonitoringReplication"></a> データベース レプリケーションの監視手順  

##### <a name="to-monitor-high-level-site-to-site-database-replication-status"></a>サイト間のデータベース レプリケーションのステータスの概要を表示するには    
1.  Configuration Manager コンソールで、[ **監視** ] をクリックします。  

2.  **[監視]** ワークスペースで **[サイト階層]** をクリックし、 **[階層図]** ビューを開きます。  

3.  マウス ポインターを 2 つのサイトを結んでいる線の上に置くと、これらのサイトのグローバルなステータスおよびサイト データ レプリケーションのステータスが表示されます。  

##### <a name="to-monitor-the-replication-status-for-a-replication-link"></a>レプリケーション リンクのレプリケーション ステータスを監視するには    
1.  Configuration Manager コンソールで、[ **監視** ] をクリックします。  

2.  **[監視]** ワークスペースで、 **[データベースのレプリケーション]**をクリックしてから、監視するリンクのレプリケーション リンクを選択します。 次に、ワークスペースで、適切なタブを選択し、そのリンクのレプリケーション ステータスの各種詳細を表示します。  
