---
title: PKI 証明書を展開する
titleSuffix: Configuration Manager
description: ステップバイステップの例に従って、System Center Configuration Manager で使用される PKI 証明書を作成および展開する方法について説明します。
ms.date: 02/14/2017
ms.prod: configuration-manager
ms.technology: configmgr-other
ms.topic: conceptual
ms.assetid: 3417ff88-7177-4a0d-8967-ab21fe7eba17
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 8e857d42654544308c0b008776110862a202a8ba
ms.sourcegitcommit: 48098f9fb2f447672bf36d50c9f58a3d26acb9ed
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 12/14/2018
ms.locfileid: "53417525"
---
# <a name="step-by-step-example-deployment-of-the-pki-certificates-for-system-center-configuration-manager-windows-server-2008-certification-authority"></a>System Center Configuration Manager の PKI 証明書の展開手順の例:Windows Server 2008 証明機関

「オブジェクトの*適用対象: System Center Configuration Manager (Current Branch)*

このステップバイステップの展開例では、Windows Server 2008 の証明機関 (CA) を使用し、System Center Configuration Manager で使用される公開キー基盤 (PKI) 証明書を作成および展開する方法について説明します。 これらの手順は企業の証明機関 (CA) および証明書テンプレートを使用します。 これらの手順は、テスト ネットワークでの概念実証としてのみ適しています。  

 必要な証明書の実装方法は 1 つではないので、運用環境で必要な証明書を展開するための手順と推奨される運用方法については、特定の PKI 展開のドキュメントを参照してください。 証明書の要件の詳細については、「[System Center Configuration Manager での PKI 証明書の要件](../../../core/plan-design/network/pki-certificate-requirements.md)」をご覧ください。  

> [!TIP]
>  このトピックの説明は、「テスト ネットワークの要件」セクションで説明されていないオペレーティング システムにも適用できます。 ただし、Windows Server 2012 で、発行元 CA を実行する場合、証明書テンプレートのバージョンは求められません。 代わりに、テンプレートのプロパティの **[互換性]** タブでバージョンを指定します。  
> 
> - **証明機関**:**Windows Server 2003**  
>   -   **証明書の受信者**:**Windows XP / Server 2003**  

## <a name="in-this-section"></a>このセクションの内容  
 以降のセクションで説明する例のステップバイステップの手順では、System Center Configuration Manager で使用できる次の証明書を作成して展開します。  

 [テスト ネットワークの要件](#BKMK_testnetworkenvironment)  

 [証明書の概要](#BKMK_overview2008)  

 [IIS を実行するサイト システム用の Web サーバー証明書の展開](#BKMK_webserver2008_cm2012)  

 [クラウドベースの配布ポイント用のサービス証明書の展開](#BKMK_clouddp2008_cm2012)  

 [Windows コンピューター用のクライアント証明書の展開](#BKMK_client2008_cm2012)  

 [配布ポイント用のクライアント証明書の展開](#BKMK_clientdistributionpoint2008_cm2012)  

 [モバイル デバイス用の登録証明書の展開](#BKMK_mobiledevices2008_cm2012)  

 [AMT 用の証明書の展開](#BKMK_AMT2008_cm2012)  

 [Mac コンピューター用のクライアント証明書の展開](#BKMK_MacClient_SP1)  

##  <a name="BKMK_testnetworkenvironment"></a> テスト ネットワークの要件  
 手順には次の要件があります。  

-   テスト ネットワークでは、Windows Server 2008 で Active Directory ドメイン サービスが動作しており、これが単一のドメイン、単一のフォレストとしてインストールされていること。  

-   Active Directory 証明書サービスの役割がインストールされており、エンタープライズ ルート証明機関 (CA) として構成されている Windows Server 2008 Enterprise Edition を実行するメンバー サーバーがあること。  

-   1 台のコンピューターに Windows Server 2008 (Standard Edition か Enterprise Edition、R2 以降) がインストールされ、そのコンピューターがメンバー サーバーとして指定されており、インターネット インフォメーション サービス (IIS) がインストールされていること。 このコンピューターは System Center Configuration Manager サイト システム サーバーになります。イントラネットでクライアント接続をサポートする場合は、イントラネット完全修飾ドメイン名 (FQDN) で構成し、System Center Configuration Manager で登録されたモバイル デバイスとインターネットのクライアントをサポートする必要がある場合は、インターネット FQDN で構成します。  

-   最新の Service Pack がインストールされた Windows Vista クライアントがあり、コンピューターが ASCII 文字のコンピューター名で設定され、ドメインに参加していること。 このコンピューターは、System Center Configuration Manager クライアント コンピューターになります。  

-   ルート ドメイン管理者のアカウントまたはエンタープライズ管理者のアカウントでサインインでき、そのアカウントを使ってこの展開例のすべての手順を実行できること。  

##  <a name="BKMK_overview2008"></a> 証明書の概要  
 次の表では、System Center Configuration Manager に必要な PKI 証明書の種類の一覧を示し、それぞれの使用方法を説明しています。  

|証明書の要件|証明書の説明|  
|-----------------------------|-----------------------------|  
|IIS を実行するサイト システム用のWeb サーバー証明書の展開|この証明書は、データの暗号化およびクライアントに対するサーバーの認証に使用されます。 System Center Configuration Manager の外部から、インターネット インフォメーション サービス (IIS) を実行しており System Center Configuration Manager で HTTPS を使用するように設定されているサイト システム サーバーにインストールする必要があります。<br /><br /> この証明書の設定およびインストール手順は、このトピックの「[IIS を実行するサイト システム用の Web サーバー証明書の展開](#BKMK_webserver2008_cm2012) 」を参照してください。|  
|クラウドベースの配布ポイントに接続するクライアント用のサービス証明書|この証明書の構成およびインストール手順については、このトピックの「[クラウドベースの配布ポイント用のサービス証明書の展開](#BKMK_clouddp2008_cm2012) 」を参照してください。<br /><br /> **重要:** この証明書は、Windows Azure 管理証明書と併用されます。 この管理証明書の詳細については、MSDN ライブラリの Windows Azure プラットフォーム セクションの「[Windows Azure の管理証明書を作成する方法](http://go.microsoft.com/fwlink/p/?LinkId=220281)」および「[Windows Azure サブスクリプションへの管理証明書の追加方法](http://go.microsoft.com/fwlink/?LinkId=241722)」を参照してください。|  
|Windows コンピューター用のクライアント証明書|この証明書は、HTTPS を使用するように設定されたサイト システムに対する System Center Configuration Manager クライアント コンピューターの認証に使用されます。 管理ポイントおよび状態移行ポイントが HTTPS を使用するように設定されたときに動作状況を監視するためにも使用されます。 System Center Configuration Manager の外部からコンピューターにインストールする必要があります。<br /><br /> この証明書の設定およびインストール手順は、このトピックの「[Windows コンピューター用のクライアント証明書の展開](#BKMK_client2008_cm2012)」を参照してください。|  
|配布ポイント用のクライアント証明書|この証明書には、次の 2 つの目的があります。<br /><br /> 証明書は、配布ポイントがステータス メッセージを 管理ポイントに送信する前に、HTTPS が有効な管理ポイントに対する配布ポイントの認証に使用されます。<br /><br /> **[クライアントの PXE サポートを有効にする]** の配布ポイントのオプションがオンになっていると、オペレーティング システムの展開中に HTTPS が有効な管理ポイントに接続できるように、PXE ブートを実行するコンピューターに証明書が送信されます。<br /><br /> この証明書を設定しインストールする手順については、このトピックの「[配布ポイント用のクライアント証明書の展開](#BKMK_clientdistributionpoint2008_cm2012)」を参照してください。|  
|モバイル デバイス用の登録証明書|この証明書は、HTTPS を使用するように設定されたサイト システムに対する System Center Configuration Manager モバイル デバイス クライアントの認証に使用されます。 System Center Configuration Manager でのモバイル デバイス登録の一環としてインストールする必要があり、構成済みの証明書テンプレートをモバイル デバイス クライアント設定として選択します。<br /><br /> この証明書を設定する手順については、このトピックの「[モバイル デバイス用の登録証明書の展開](#BKMK_mobiledevices2008_cm2012)」を参照してください。|  
|Intel AMT 用証明書|Intel AMT ベースのコンピューターの帯域外管理に関する証明書には 3 つあります。<ul><li>Active Management Technology (AMT) プロビジョニング証明書</li><li>AMT Web サーバー証明書</li><li>必要に応じて、802.1X 有線または無線ネットワークのクライアント認証証明書</li></ul>AMT プロビジョニング証明書は、System Center Configuration Manager の外部から帯域外サービス ポイント コンピューターにインストールする必要があります。その後、帯域外サービス ポイントのプロパティでインストールした証明書を選択します。 AMT Web サーバー証明書およびクライアント認証証明書は AMT プロビジョニングおよび管理の間にインストールされます。帯域外管理コンポーネントのプロパティで構成した証明書テンプレートを選択します。<br /><br /> これらの証明書を設定する手順については、このトピックの「[AMT 用の証明書の展開](#BKMK_AMT2008_cm2012)」を参照してください。|  
|Mac コンピューター用のクライアント証明書|System Center Configuration Manager の登録を使用し、構成済みの証明書テンプレートをモバイル デバイス クライアント設定として選択するときに、Mac コンピューターからこの証明書を要求してインストールすることができます。<br /><br /> この証明書を構成する手順については、このトピックの「[Mac コンピューター用のクライアント証明書の展開](#BKMK_MacClient_SP1)」を参照してください。|  

##  <a name="BKMK_webserver2008_cm2012"></a> IIS を実行するサイト システム用の Web サーバー証明書の展開  
 この証明書の展開には次の手順が含まれています。  

-   証明機関で Web サーバー証明書テンプレートを作成および発行する  

-   Web サーバー証明書を要求する  

-   IIS が Web サーバー証明書を使用するように構成する  

###  <a name="BKMK_webserver22008"></a> 証明機関で Web サーバー証明書テンプレートを作成および発行する  
 この手順により、System Center Configuration Manager サイト システムの証明書テンプレートを作成し、それを証明機関に追加します。  

##### <a name="to-create-and-issue-the-web-server-certificate-template-on-the-certification-authority"></a>証明機関で Web サーバー証明書テンプレートを作成および発行するには  

1.  IIS を実行する System Center Configuration Manager サイト システムをインストールするために、メンバー サーバーを含む **ConfigMgr IIS Servers** というセキュリティ グループを作成します。  

2.  証明書サービスがインストールされているメンバー サーバーの証明機関のコンソールで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して **[証明書テンプレート]** コンソールを読み込みます。  

3.  [結果] ウィンドウで、**[テンプレート表示名]** 列に **[Web サーバー]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

4.  **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

    > [!IMPORTANT]  
    >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

5.  **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr Web サーバー証明書**」など、Configuration Manager のサイト システムで使用される Web 証明書を生成するテンプレート名を入力します。  

6.  **[サブジェクト名]** タブを選択し、**[要求に含まれる]** が選択されていることを確認します。  

7.  **[セキュリティ]** タブを選択し、**[Domain Admins]** および **[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

8.  **[追加]** を選択して、テキスト ボックスに「**ConfigMgr IIS Servers**」と入力し、**[OK]** を選択します。  

9. このグループに対して **[登録]** アクセス許可を選択し、**[読み取り]** アクセス許可をオフにしません。  

10. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

11. [証明機関] コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

12. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr Web サーバー証明書]** を選択し、**[OK]** をクリックします。  

13. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

###  <a name="BKMK_webserver32008"></a> Web サーバー証明書を要求する  
 この手順では、サイト システム サーバーのプロパティで設定されるイントラネットおよびインターネット FQDN を指定し、Web サーバー証明書を IIS を実行するメンバー サーバーにインストールできます。  

##### <a name="to-request-the-web-server-certificate"></a>Web サーバー証明書を要求するには  

1.  IIS を実行するメンバー サーバーを再起動し、構成した **[読み取り]** および **[登録]** のアクセス許可を使用して、コンピューターが作成した証明書テンプレートにアクセスできることを確認します。  

2.  **[スタート]**、**[ファイル名を指定して実行]** の順に選択し、「**mmc.exe**」と入力します。 空のコンソールで、**[ファイル]** を選択し、次に **[スナップインの追加と削除]** を選択します。  

3.  **[スナップインの追加と削除]** ダイアログ ボックスで、**[利用できるスナップイン]** リストから **[証明書]** を選択し、**[追加]** を選択します。  

4.  **[証明書スナップイン]** ダイアログ ボックスで **[コンピューター アカウント]** を選択し、**[次へ]** を選択します。  

5.  **[コンピューターの選択]** ダイアログ ボックスで、**[ローカル コンピューター: (このコンソールを実行しているコンピューター)]** が選択されていることを確認して、**[完了]** を選択します。  

6.  **[スナップインの追加と削除]** ダイアログ ボックスで、**[OK]** を選択します。  

7.  コンソールで、**[証明書 (ローカル コンピューター)]** を展開し、**[個人]** を選択します。  

8.  **[証明書]** を右クリックして、**[すべてのタスク]** を選択し、次に **[新しい証明書の要求]** を選択します。  

9. **[開始する前に]** ページで、**[次へ]** を選択します。  

10. **[証明書の登録ポリシーの選択]** ページを表示する場合は、**[次へ]** を選択します。  

11. **[証明書の要求]** ページで、使用可能な証明書の一覧から **[ConfigMgr Web サーバー証明書]** を見つけて、**[この証明書の登録には詳細情報が必要です] を選択します。** 設定を構成するにはここをクリックします。  

12. **[証明書のプロパティ]** ダイアログ ボックスの **[サブジェクト]** タブでは、**[サブジェクト名]** を一切変更しないでください。 つまり、**[サブジェクト名]** の **[値]** ボックスは空欄のままにしておきます。 その代わりに、**[名前の変更]** セクションの **[種類]** ドロップダウン リストで、**[DNS]** を選択します。  

13. **[値]** ボックスで、System Center Configuration Manager サイト システムのプロパティで指定する FQDN 値を指定し、**[OK]** を選択して **[証明書のプロパティ]** ダイアログ ボックスを閉じます。  

     次に例を示します。  

    -   サイト システムがイントラネット経由のクライアント接続のみを許可する場合は、サイト システム サーバーのイントラネット FQDN は **server1.internal.contoso.com** になります。「**server1.internal.contoso.com**」と入力し、**[追加]** を選択します。  

    -   サイト システムがイントラネットからとインターネットからのクライアント接続を許可する場合は、 サイト システム サーバーのイントラネット FQDN は **server1.internal.contoso.com** で、サイト システム サーバーのインターネット FQDN は **server.contoso.com**となります。  

        1.  「**server1.internal.contoso.com**」と入力し、**[追加]** を選択します。  

        2.  「**server.contoso.com**」と入力し、**[追加]** を選択します。  

        > [!NOTE]  
        >  System Center Configuration Manager の FQDN は任意の順番で指定できます。 しかし、モバイル デバイスやプロキシ Web サーバーなど、証明書を使用するすべてのデバイスが、サブジェクトの別名 (SAN) の証明書や SAN に複数の値が存在する証明書も使用できるのか確認します。 証明書における SAN の値についてデバイスの対応が限られている場合は、FQDN の順序を変更したり、または [サブジェクト] の値を代わりに使用したりする必要があることもあります。  

14. **[証明書の要求]** ページで、使用可能な証明書の一覧から **[ConfigMgr Web サーバー証明書]** を選択し、**[登録]** を選択します。  

15. **[証明書のインストール結果]** ページで、証明書がインストールされるのを待ち、**[完了]** を選択します。  

16. **[証明書 (ローカル コンピューター)]** を閉じます。  

###  <a name="BKMK_webserver42008"></a> IIS が Web サーバー証明書を使用するように構成する  
 この手順により、インストールした証明書を IIS の **[既定の Web サイト]** にバインドします。  

##### <a name="to-set-up-iis-to-use-the-web-server-certificate"></a>IIS が Web サーバー証明書を使用するように設定するには  

1. インストールした IIS のあるメンバー サーバーで、**[スタート]**、**[プログラム]**、**[管理ツール]**、**[インターネット インフォメーション サービス (IIS) マネージャー]** の順に選択します。  

2. **[サイト]** を展開し、**[既定の Web サイト]** を右クリックして、**[バインドの編集]** を選択します。  

3. **[https]** エントリを選択して、**[編集]** を選択します。  

4. **[サイト バインドの編集]** ダイアログ ボックスで、ConfigMgr Web サーバー証明書テンプレートを使用して、要求した証明書を選択し、**[OK]** を選択します。  

   > [!NOTE]  
   >  正しい証明書が不明な場合は、証明書を 1 つ選択して、**[表示]** を選択します。 これにより、選択した証明書の詳細を、証明書スナップインの証明書と比較することができます。 たとえば、証明書スナップインには、証明書の要求に使用された証明書テンプレートが表示されます。 次に、ConfigMgr Web サーバー証明書テンプレートで要求された証明書の証明書拇印を **[サイト バインドの編集]** ダイアログ ボックスで現在選択されている証明書の証明書拇印と比較できます。  

5. **[サイト バインドの編集]** ダイアログ ボックスで **[OK]** を選択し、次に **[閉じる]** を選択します。  

6. **インターネット インフォメーション サービス (IIS) マネージャー** を閉じます。  

   これで、メンバー サーバーに System Center Configuration Manager の Web サーバー証明書が設定されました。  

> [!IMPORTANT]  
>  System Center Configuration Manager サイト システム サーバーをこのコンピューターにインストールするときは、必ずサイト システムのプロパティで、証明書を要求するときに指定したものと同じ FQDN を指定します。  

##  <a name="BKMK_clouddp2008_cm2012"></a> クラウドベースの配布ポイント用のサービス証明書の展開  

この証明書の展開には次の手順が含まれています。  

-   [証明機関でカスタム Web サーバー証明書テンプレートを作成および発行する](#BKMK_clouddpcreating2008)  

-   [カスタム Web サーバー証明書を要求する](#BKMK_clouddprequesting2008)  

-   [クラウドベースの配布ポイント用にカスタム Web サーバー証明書をエクスポートする](#BKMK_clouddpexporting2008)  

###  <a name="BKMK_clouddpcreating2008"></a> 証明機関でカスタム Web サーバー証明書テンプレートを作成および発行する  
 この手順では、Web サーバー証明書テンプレートに基づいてカスタム証明書テンプレートを作成します。 この証明書は System Center Configuration Manager のクラウドベースの配布ポイント用であり、プライベート キーをエクスポート可能にする必要があります。 証明書テンプレートを作成したら、証明機関に追加します。  

> [!NOTE]
>  この手順では、IIS を実行するサイト システム用に作成した Web サーバー証明書テンプレートとは別の証明書テンプレートを使用します。 どちらの証明書にもサーバー認証機能が必要ですが、クラウドベースの配布ポイント用の証明書では、サブジェクト名のカスタム定義値を入力する必要があり、秘密キーをエクスポートする必要があります。 セキュリティのベスト プラクティスとして、必要でない限りは、証明書テンプレートが秘密キーをエクスポートできるように設定するべきではありません。 クラウドベースの配布ポイントではこの設定が必要です。証明書を証明書ストアから選択するのではなく、ファイルとしてインポートする必要があるからです。  
> 
>  この証明書用に新しい証明書テンプレートを作成すると、秘密キーをエクスポート可能な証明書を要求できるコンピューターを制限することができます。 運用ネットワークでは、この証明書に対して次のような変更を加えることもご検討ください。  
> 
> - セキュリティを強化するため、証明書をインストールする承認が必要です。  
>   -   証明書の有効期間を長くします。 有効期間が切れる前には毎回証明書をエクスポートおよびインポートする必要があるため、有効期間を長くすると、この手順を繰り返す回数を減らすことができます。 ただし、有効期間を長くすると、攻撃者が秘密キーを解読して証明書を盗み出す時間を長く与えることになり、証明書のセキュリティが低下します。  
>   -   IIS で使用している標準の Web サーバー証明書とこの証明書を区別できるように、証明書のサブジェクトの別名 (SAN) にはカスタム値を使用します。  

##### <a name="to-create-and-issue-the-custom-web-server-certificate-template-on-the-certification-authority"></a>証明機関でカスタム Web サーバー証明書テンプレートを作成および発行するには  

1.  クラウドベースの配布ポイントを管理する System Center Configuration Manager プライマリ サイト サーバーをインストールするために、メンバー サーバーを含む **ConfigMgr Site Servers** というセキュリティ グループを作成します。  

2.  証明機関コンソールを実行しているメンバー サーバーで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して、証明書テンプレート管理コンソールを読み込みます。  

3.  [結果] ウィンドウで、**[テンプレート表示名]** 列に **[Web サーバー]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

4.  **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

    > [!IMPORTANT]  
    >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

5.  **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、**「ConfigMgr クラウド ベースの配布ポイント証明書」** など、クラウド ベースの配布ポイントの Web サーバーの証明書を生成するテンプレート名を入力します。  

6.  **[要求処理]** タブを選択し、**[秘密キーのエクスポートを許可する]** を選択します。  

7.  **[セキュリティ]** タブを選択し、**[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

8.  **[追加]** を選択して、テキスト ボックスに「**ConfigMgr Site Server**」と入力し、**[OK]** を選択します。  

9. このグループに対して **[登録]** アクセス許可を選択し、**[読み取り]** をオフにしません。  

    > [!NOTE]
    > **[暗号]** タブの **[最小キー サイズ]** が **2048** に設定済みであることを確認します。

10. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

11. [証明機関] コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

12. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr クラウドベースの配布ポイント証明書]** を選択し、**[OK]** を選択します。  

13. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

###  <a name="BKMK_clouddprequesting2008"></a> カスタム Web サーバー証明書を要求する  
 この手順では、カスタム Web サーバー証明書を要求し、サイト サーバーを実行するメンバー サーバーにインストールします。  

##### <a name="to-request-the-custom-web-server-certificate"></a>カスタム Web サーバー証明書を要求するには  

1.  **[ConfigMgr Site Servers]** セキュリティ グループを作成および構成したら、メンバー サーバーを再起動します。これによって、コンピューターは、構成した **[読み取り]** および **[登録]** のアクセス許可を使用して、作成した証明書テンプレートにアクセスできるようになります。  

2.  **[スタート]**、**[ファイル名を指定して実行]** の順に選択し、「**mmc.exe**」と入力します。 空のコンソールで、**[ファイル]** を選択し、次に **[スナップインの追加と削除]** を選択します。  

3.  **[スナップインの追加と削除]** ダイアログ ボックスで、**[利用できるスナップイン]** リストから **[証明書]** を選択し、**[追加]** を選択します。  

4.  **[証明書スナップイン]** ダイアログ ボックスで **[コンピューター アカウント]** を選択し、**[次へ]** を選択します。  

5.  **[コンピューターの選択]** ダイアログ ボックスで、**[ローカル コンピューター: (このコンソールを実行しているコンピューター)]** が選択されていることを確認して、**[完了]** を選択します。  

6.  **[スナップインの追加と削除]** ダイアログ ボックスで、**[OK]** を選択します。  

7.  コンソールで、**[証明書 (ローカル コンピューター)]** を展開し、**[個人]** を選択します。  

8.  **[証明書]** を右クリックして、**[すべてのタスク]** を選択し、次に **[新しい証明書の要求]** を選択します。  

9. **[開始する前に]** ページで、**[次へ]** を選択します。  

10. **[証明書の登録ポリシーの選択]** ページを表示する場合は、**[次へ]** を選択します。  

11. **[証明書の要求]** ページの使用可能な証明書の一覧から **[ConfigMgr クラウド ベースの配布ポイント証明書]** を見つけて、**[この証明書の登録には詳細情報が必要です]** を選択します。設定を構成するにはここを選択します。  

12. **[証明書のプロパティ]** ダイアログ ボックスの **[サブジェクト]** タブで、**[サブジェクト名]** の **[種類]** として **[共通名]** を選択します。  

13. **[値]** ボックスに、任意のサービス名と、FQDN 形式のドメイン名を入力します。 例: **clouddp1.contoso.com**。  

    > [!NOTE]  
    >  名前空間内でサービス名は一意にします。 このサービス名を、Windows Azure から自動生成される ID (GUID) および IP アドレスに対応付けるために、DNS を使用してエイリアス (CNAME レコード) を作成します。  

14. **[追加]** を選択し、**[OK]** を選択して、**[証明書のプロパティ]** ダイアログ ボックスを閉じます。  

15. **[証明書の要求]** ページで、使用可能な証明書の一覧から **[ConfigMgr クラウドベースの配布ポイント証明書]** を選択し、**[登録]** を選択します。  

16. **[証明書のインストール結果]** ページで、証明書がインストールされるのを待ち、**[完了]** を選択します。  

17. **[証明書 (ローカル コンピューター)]** を閉じます。  

###  <a name="BKMK_clouddpexporting2008"></a> クラウドベースの配布ポイント用にカスタム Web サーバー証明書をエクスポートする  
 この手順では、カスタム Web サーバー証明書をファイルにエクスポートして、クラウドベースの配布ポイントを作成するときに証明書をインポートできるようにします。  

##### <a name="to-export-the-custom-web-server-certificate-for-cloud-based-distribution-points"></a>クラウドベースの配布ポイント用に Web サーバー証明書をエクスポートするには  

1. **[証明書 (ローカル コンピューター)]** コンソールで、インストールした証明書を右クリックし、**[すべてのタスク]**、**[エクスポート]** の順に選択します。  

2. 証明書のエクスポート ウィザードで、**[次へ]** を選択します。  

3. **[秘密キーのエクスポート]** ページで、**[はい]** を選択し、秘密キーをエクスポートしてから、**[次へ]** を選択します。  

   > [!NOTE]  
   >  このオプションが使用できない場合、その証明書は秘密キーをエクスポートするオプションなしで作成されています。 この場合、証明書を必要な形式でエクスポートできません。 秘密キーをエクスポートできるように証明書テンプレートを設定して、再び証明書を要求する必要があります。  

4. **[エクスポート ファイルの形式]** ページで **[Personal Information Exchange – PKCS #12 (.PFX)]** オプションが選択されていることを確認します。  

5. **[パスワード]** ページで、エクスポートした証明書とその秘密キーを保護するために強力なパスワードを指定し、**[次へ]** を選択します。  

6. **[エクスポートするファイル]** ページで、エクスポートするファイルの名前を指定し、**[次へ]** を選択します。  

7. ウィザードを閉じるには、**[証明書のエクスポート ウィザード]** ページで **[完了]** を選択し、確認ダイアログ ボックスで **[OK]** を選択します。  

8. **[証明書 (ローカル コンピューター)]** を閉じます。  

9. ファイルをセキュリティで保護して保存し、System Center Configuration Manager コンソールからアクセスできることを確認します。  

   これで、クラウドベースの配布ポイントを作成するときに、証明書をインポートできるようになりました。  

##  <a name="BKMK_client2008_cm2012"></a> Windows コンピューター用のクライアント証明書の展開  
 この証明書の展開には次の手順が含まれています。  

-   証明機関でワークステーション認証証明書テンプレートを作成および発行する  

-   グループ ポリシーを使用してワークステーション認証テンプレートの自動登録を構成する  

-   ワークステーション認証証明書を自動登録し、コンピューターへのインストールを確認する  

###  <a name="BKMK_client02008"></a> 証明機関でワークステーション認証証明書テンプレートを作成および発行する  
 この手順により、System Center Configuration Manager クライアント コンピューターの証明書テンプレートを作成し、それを証明機関に追加します。  

##### <a name="to-create-and-issue-the-workstation-authentication-certificate-template-on-the-certification-authority"></a>証明機関でワークステーション認証証明書テンプレートを作成および発行するには  

1.  証明機関コンソールを実行しているメンバー サーバーで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して、証明書テンプレート管理コンソールを読み込みます。  

2.  結果ウィンドウで、**[テンプレート表示名]** 列に **[ワークステーション認証]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

3.  **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

    > [!IMPORTANT]  
    >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

4.  **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr クライアント証明書**」など、Configuration Manager クライアント コンピューターで使用されるクライアント証明書を生成するテンプレート名を入力します。  

5.  **[セキュリティ]** タブを選択し、**[ドメイン コンピューター]** グループを選択して、**[読み取り]** と **[自動登録]** の追加のアクセス許可を選択します。 **[登録]** をオフにしないでください。  

6.  **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

7.  [証明機関] コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

8.  **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr クライアント証明書]** を選択し、**[OK]** を選択します。  

9. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

###  <a name="BKMK_client12008"></a> グループ ポリシーを使用してワークステーション認証テンプレートの自動登録を構成する  
 この手順により、コンピューターにクライアント証明書を自動登録するグループ ポリシーを設定します。  

##### <a name="to-set-up-autoenrollment-of-the-workstation-authentication-template-by-using-group-policy"></a>グループ ポリシーを使用してワークステーション認証テンプレートの自動登録を設定するには  

1.  ドメイン コントローラーで、**[開始]**、**[管理ツール]**、**[グループ ポリシー管理]** の順に選択します。  

2.  ドメインに移動して、ドメインを右クリックし、**[このドメインに GPO を作成し、このコンテナーにリンクする]** を選択します。  

    > [!NOTE]  
    >  この手順では、Active Directory ドメイン サービスでインストールされる既定のドメイン ポリシーを編集するのではなく、カスタム設定の新しいグループ ポリシーを推奨される方法で作成します。 このグループ ポリシーをドメイン レベルで割り当てると、ドメイン内のすべてのコンピューターに適用されます。 運用環境では、選択したコンピューターにのみ登録されるように自動登録を制限することができます。 グループ ポリシーを組織単位レベルで割り当てることも、ドメイン グループ ポリシーがグループ内のコンピューターにのみ適用されるように、セキュリティ グループを使用してドメイン グループ ポリシーをフィルタリングすることもできます。 自動登録を制限する場合は、管理ポイントとして設定されているサーバーを必ず含めてください。  

3.  **[新しい GPO]** ダイアログ ボックスに、「**自動登録証明書**」など、新しいグループ ポリシーの名前を入力し、**[OK]** を選択します。  

4.  結果ウィンドウの **[リンクされたグループ ポリシー オブジェクト]** タブで、新しいグループのポリシーを右クリックし、**[編集]** を選択します。  

5.  **[グループ ポリシー管理エディター]** で、**[コンピューターの構成]** の下にある **[ポリシー]** を展開し、**[Windows の設定]** / **[セキュリティ設定]** / **[公開キーのポリシー]** の順に移動します。  

6.  **[証明書サービス クライアント - 自動登録]** という名前のオブジェクトの種類を右クリックして、**[プロパティ]** を選択します。  

7.  **[構成モデル]** のドロップダウン リストから、**[有効]**、**[期限切れの証明書と保留中の証明書を更新し、失効した証明書を削除する]**、**[証明書テンプレートを使用する証明書を更新する]** を順に選択し、**[OK]** を選択します。  

8.  **[グループ ポリシー管理]** を閉じます。  

###  <a name="BKMK_client22008"></a> ワークステーション認証証明書を自動登録し、コンピューターへのインストールを確認する  
 この手順により、クライアント証明書をコンピューターにインストールし、インストールを確認します。  

##### <a name="to-automatically-enroll-the-workstation-authentication-certificate-and-verify-its-installation-on-the-client-computer"></a>ワークステーション認証証明書を自動登録し、クライアント コンピューターへのインストールを確認するには  

1. ワークステーション コンピューターを再起動し、少し待ってからサインインします。  

   > [!NOTE]  
   >  証明書の自動登録の正常な完了を保証するには、コンピューターを再起動するのが最も確実です。  

2. 管理者特権があるアカウントでサインインします。  

3. 検索ボックスで「**mmc.exe.**」と入力し、**Enter** キーを押します。  

4. 空の管理コンソールで、**[ファイル]** を選択し、次に **[スナップインの追加と削除]** を選択します。  

5. **[スナップインの追加と削除]** ダイアログ ボックスで、**[利用できるスナップイン]** リストから **[証明書]** を選択し、**[追加]** を選択します。  

6. **[証明書スナップイン]** ダイアログ ボックスで **[コンピューター アカウント]** を選択し、**[次へ]** を選択します。  

7. **[コンピューターの選択]** ダイアログ ボックスで、**[ローカル コンピューター: (このコンソールを実行しているコンピューター)]** が選択されていることを確認して、**[完了]** を選択します。  

8. **[スナップインの追加と削除]** ダイアログ ボックスで、**[OK]** を選択します。  

9. コンソールで **[証明書 (ローカル コンピューター)]**、**[個人]** の順に展開して、**[証明書]** を選択します。  

10. 結果ウィンドウで、**[使用目的]** 列に **[クライアント認証]** と表示されている証明書があること、**[証明書テンプレート]** 列に **[ConfigMgr クライアント証明書]** が表示されていることを確認します。  

11. **[証明書 (ローカル コンピューター)]** を閉じます。  

12. 管理ポイントとして設定されるサーバーもクライアント証明書も持っているかを確認するメンバー サーバーについて、手順 1 ～ 11 を繰り返します。  

    これで、コンピューターに System Center Configuration Manager のクライアント証明書が設定されました。  

##  <a name="BKMK_clientdistributionpoint2008_cm2012"></a> 配布ポイント用のクライアント証明書の展開  

> [!NOTE]  
>  この証明書は、PXE ブートを使用しないメディア イメージにも使用できます。これは、証明書の要件が同じためです。  

 この証明書の展開には次の手順が含まれています。  

-   カスタムのワークステーション認証証明書テンプレートを作成して証明機関に発行する  

-   カスタムのワークステーション認証証明書を要求する  

-   配布ポイント用にクライアント証明書をエクスポートする  

###  <a name="BKMK_clientdistributionpoint02008"></a> カスタムのワークステーション認証証明書テンプレートを作成して証明機関に発行する  
 この手順では、秘密キーをエクスポートできるように System Center Configuration Manager 配布ポイントのカスタム証明書テンプレートを作成して、証明書テンプレートを証明機関に追加します。  

> [!NOTE]
>  この手順では、クライアント コンピューター用に作成した証明書テンプレートとは別の証明書テンプレートを使用します。 どちらの証明書もクライアント認証機能を必要としますが、配布ポイント用の証明書では、秘密キーがエクスポートできる必要があります。 セキュリティのベスト プラクティスとして、必要でない限りは、証明書テンプレートが秘密キーをエクスポートできるように設定するべきではありません。 配布ポイントではこの設定が必要です。証明書を証明書ストアから選択するのではなく、ファイルとしてインポートする必要があるからです。  
> 
>  この証明書用に新しい証明書テンプレートを作成すると、秘密キーをエクスポート可能な証明書を要求できるコンピューターを制限することができます。 例としている展開では、IIS を実行する System Center Configuration Manager サイト システム サーバー用に以前作成したセキュリティ グループが対象になります。 IIS サイト システムの役割を配布するネットワークでは、配布ポイントを実行するサーバー用に新しいセキュリティ グループを作成して、それらのサイト システム サーバーのみに証明書を制限することを考慮します。 次のような変更を加えることも考慮します。  
> 
> - セキュリティを強化するため、証明書をインストールする承認が必要です。  
>   -   証明書の有効期間を長くします。 有効期間が切れる前には毎回証明書をエクスポートおよびインポートする必要があるため、有効期間を長くすると、この手順を繰り返す回数を減らすことができます。 ただし、有効期間を長くすると、攻撃者が秘密キーを解読して証明書を盗み出す時間を長く与えることになり、証明書のセキュリティが低下します。  
>   -   証明書のサブジェクトまたはサブジェクトの別名 (SAN) にカスタム値を使用して、標準のクライアント証明書とこの証明書を区別できます。 この方法は複数の配布ポイントで同じ証明書を使用する場合に特に有用です。  

##### <a name="to-create-and-issue-the-custom-workstation-authentication-certificate-template-on-the-certification-authority"></a>カスタムのワークステーション認証証明書テンプレートを作成して証明機関に発行するには  

1.  証明機関コンソールを実行しているメンバー サーバーで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して、証明書テンプレート管理コンソールを読み込みます。  

2.  結果ウィンドウで、**[テンプレート表示名]** 列に **[ワークステーション認証]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

3.  **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

    > [!IMPORTANT]  
    >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

4.  **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr クライアントの配布ポイント証明書**」など、配布ポイントのクライアント認証証明書を生成するテンプレート名を入力します。  

5.  **[要求処理]** タブを選択し、**[秘密キーのエクスポートを許可する]** を選択します。  

6.  **[セキュリティ]** タブを選択し、**[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

7.  **[追加]** を選択して、テキスト ボックスに「**ConfigMgr IIS Servers**」と入力し、**[OK]** を選択します。  

8.  このグループに対して **[登録]** アクセス許可を選択し、**[読み取り]** をオフにしません。  

9. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

10. [証明機関] コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

11. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr クライアントの配布ポイント証明書]** を選択し、**[OK]** を選択します。  

12. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

###  <a name="BKMK_clientdistributionpoint12008"></a> カスタムのワークステーション認証証明書を要求する  
 この手順では、まずカスタムのクライアント証明書を要求し、次に IIS を実行しかつ配布ポイントとして設定されるメンバー サーバーにインストールします。  

##### <a name="to-request-the-custom-workstation-authentication-certificate"></a>カスタムのワークステーション認証証明書を要求するには  

1.  **[スタート]**、**[ファイル名を指定して実行]** の順に選択し、「**mmc.exe**」と入力します。 空のコンソールで、**[ファイル]** を選択し、次に **[スナップインの追加と削除]** を選択します。  

2.  **[スナップインの追加と削除]** ダイアログ ボックスで、**[利用できるスナップイン]** リストから **[証明書]** を選択し、**[追加]** を選択します。  

3.  **[証明書スナップイン]** ダイアログ ボックスで **[コンピューター アカウント]** を選択し、**[次へ]** を選択します。  

4.  **[コンピューターの選択]** ダイアログ ボックスで、**[ローカル コンピューター: (このコンソールを実行しているコンピューター)]** が選択されていることを確認して、**[完了]** を選択します。  

5.  **[スナップインの追加と削除]** ダイアログ ボックスで、**[OK]** を選択します。  

6.  コンソールで、**[証明書 (ローカル コンピューター)]** を展開し、**[個人]** を選択します。  

7.  **[証明書]** を右クリックして、**[すべてのタスク]** を選択し、次に **[新しい証明書の要求]** を選択します。  

8.  **[開始する前に]** ページで、**[次へ]** を選択します。  

9. **[証明書の登録ポリシーの選択]** ページを表示する場合は、**[次へ]** を選択します。  

10. **[証明書の要求]** ページで、使用可能な証明書の一覧から **[ConfigMgr クライアントの配布ポイント証明書]** を選択し、**[登録]** を選択します。  

11. **[証明書のインストール結果]** ページで、証明書がインストールされるのを待ち、**[完了]** を選択します。  

12. 結果ウィンドウで、**[使用目的]** 列に **[クライアント認証]** と表示されている証明書があること、**[証明書テンプレート]** 列に **[ConfigMgr クライアントの配布ポイント証明書]** が表示されていることを確認します。  

13. **[証明書 (ローカル コンピューター)]** を閉じないでください。  

###  <a name="BKMK_exportclientdistributionpoint22008"></a> 配布ポイント用にクライアント証明書をエクスポートする  
 この手順では、カスタムのワークステーション認証証明書をファイルにエクスポートして、配布ポイントのプロパティにインポートできるようにします。  

##### <a name="to-export-the-client-certificate-for-distribution-points"></a>配布ポイント用にクライアント証明書をエクスポートするには  

1. **[証明書 (ローカル コンピューター)]** コンソールで、インストールした証明書を右クリックし、**[すべてのタスク]**、**[エクスポート]** の順に選択します。  

2. 証明書のエクスポート ウィザードで、**[次へ]** を選択します。  

3. **[秘密キーのエクスポート]** ページで、**[はい]** を選択し、秘密キーをエクスポートしてから、**[次へ]** を選択します。  

   > [!NOTE]  
   >  このオプションが使用できない場合、その証明書は秘密キーをエクスポートするオプションなしで作成されています。 この場合、証明書を必要な形式でエクスポートできません。 秘密キーをエクスポートできるように証明書テンプレートを設定して、再び証明書を要求する必要があります。  

4. **[エクスポート ファイルの形式]** ページで **[Personal Information Exchange – PKCS #12 (.PFX)]** オプションが選択されていることを確認します。  

5. **[パスワード]** ページで、エクスポートした証明書とその秘密キーを保護するために強力なパスワードを指定し、**[次へ]** を選択します。  

6. **[エクスポートするファイル]** ページで、エクスポートするファイルの名前を指定し、**[次へ]** を選択します。  

7. ウィザードを閉じるには、**[証明書のエクスポート ウィザード]** ページで **[完了]** を選択し、確認ダイアログ ボックスで **[OK]** を選択します。  

8. **[証明書 (ローカル コンピューター)]** を閉じます。  

9. ファイルをセキュリティで保護して保存し、System Center Configuration Manager コンソールからアクセスできることを確認します。  

   これで、配布ポイントを設定するときに証明書をインポートできるようになりました。  

> [!TIP]  
>  PXE ブートを使用しないオペレーティング システム展開用にメディア イメージを設定する場合、およびイメージをインストールするタスク シーケンスが HTTPS クライアント接続を必須とする管理ポイントに接続する必要がある場合に、同じ証明書ファイルを使用できます。  

##  <a name="BKMK_mobiledevices2008_cm2012"></a> モバイル デバイス用の登録証明書の展開  
 この証明書の展開では、1 つの手順登録証明書テンプレートを作成し、証明機関に発行します。  

### <a name="create-and-issue-the-enrollment-certificate-template-on-the-certification-authority"></a>登録証明書テンプレートを作成して証明機関に発行する  
 この手順では、System Center Configuration Manager モバイル デバイス向けの登録証明書テンプレートを作成し、証明機関に追加します。  

##### <a name="to-create-and-issue-the-enrollment-certificate-template-on-the-certification-authority"></a>登録証明書テンプレートを作成して証明機関に発行するには  

1. System Center Configuration Manager でモバイル デバイスを登録するユーザーが含まれるセキュリティ グループを作成します。  

2. 証明書サービスがインストールされているメンバー サーバーの [証明機関] コンソールで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して、証明書テンプレート管理コンソールを読み込みます。  

3. 結果ウィンドウで、**[テンプレート表示名]** 列に **[認証されたセッション]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

4. **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

   > [!IMPORTANT]  
   >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

5. **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr モバイル デバイス登録証明書**」など、System Center Configuration Manager によって管理されるモバイル デバイスの登録証明書を生成するテンプレート名を入力します。  

6. **[サブジェクト名]** タブを選択して、**[Active Directory の情報から構築する]** が選択されていることを確認し、**[サブジェクト名の形式:]** で **[共通名]** を選択し、**[サブジェクトの別名にこの情報を含める]** の **[ユーザー プリンシパル名 (UPN)]** をオフにします。  

7. **[セキュリティ]** タブを選択し、登録するモバイル デバイスを所有しているユーザーが含まれるセキュリティ グループを選択し、**[登録]** の追加のアクセス許可を選択します。 **[読み取り]** をオフにしないでください。  

8. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

9. [証明機関] コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

10. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr モバイル デバイス登録証明書]** を選択し、**[OK]** を選択します。  

11. これ以上証明書を作成して発行する必要がない場合は、[証明機関] コンソールを閉じます。  

    これで、クライアント設定でモバイル デバイス登録プロファイルを設定するときに、モバイル デバイス登録証明書テンプレートを選択できるようになりました。  

##  <a name="BKMK_AMT2008_cm2012"></a> AMT 用の証明書の展開  
 この証明書の展開には次の手順が含まれています。  

-   AMT プロビジョニング証明書を作成、発行、インストールする  

-   AMT ベース コンピューター用の Web サーバー証明書を作成し発行する  

-   802.1X AMT ベース コンピューター用のクライアント認証証明書を作成し発行する  

###  <a name="BKMK_AMTprovisioning2008"></a> AMT プロビジョニング証明書を作成、発行、インストールする  
 AMT ベースのコンピューターに内部ルート証明機関の証明書の拇印が設定されている場合、内部証明機関のプロビジョニング証明書を作成できます。 この条件に当てはまらず、外部証明機関を利用する必要がある場合、AMT プロビジョニング証明書を発行した企業からの指示に従います。この場合、通常はその企業の公開 Web サイトに証明書を要求します。 選択した外部 CA に応じた詳細な手順は、[Intel vPro Expert Center のMicrosoft vPro Manageability Web サイト](http://go.microsoft.com/fwlink/?LinkId=132001)でも確認できます。  

> [!IMPORTANT]  
>  外部 CA は Intel AMT プロビジョニング オブジェクト識別子をサポートしない場合があります。 その場合、**Intel(R) Client Setup Certificate** の OU 属性を指定してください。  

 外部 CA に AMT プロビジョニング証明書を要求する場合、帯域外サービス ポイントをホストするメンバー サーバー上のコンピューター個人用証明書ストアに証明書をインストールしてください。  

##### <a name="to-request-and-issue-the-amt-provisioning-certificate"></a>AMT プロビジョニング証明書を要求および発行するには  

1. 帯域外サービス ポイントを実行するサイト システム サーバーのコンピューター アカウントが含まれるセキュリティ グループを作成します。  

2. 証明書サービスがインストールされているメンバー サーバーの証明機関のコンソールで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して **[証明書テンプレート]** コンソールを読み込みます。  

3. [結果] ウィンドウで、**[テンプレート表示名]** 列に **[Web サーバー]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

4. **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

   > [!IMPORTANT]  
   >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

5. **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr AMT プロビジョニング**」など AMT プロビジョニング証明書テンプレートのテンプレート名を入力します。  

6. **[サブジェクト名]** タブを選択して、**[Active Directory の情報から構築する]** を選択し、**[共通名]** を選択します。  

7. **[拡張機能]** タブを選択して、**[アプリケーション ポリシー]** が選択されていることを確認し、**[編集]** を選択します。  

8. **[アプリケーション ポリシー拡張の編集]** ダイアログ ボックスで、**[追加]** を選択します。  

9. **[アプリケーション ポリシーの追加]** ダイアログ ボックスで、**[新規]** を選択します。  

10. **[新しいアプリケーションのポリシー]** ダイアログ ボックスで、**[名前]** フィールドに「**AMT プロビジョニング**」と入力し、**[オブジェクト識別子]** の番号「**2.16.840.1.113741.1.2.3**」を入力します。  

11. **[OK]** を選択して、次に **[アプリケーション ポリシーの追加]** ダイアログ ボックスの **[OK]** を選択します。  

12. **[アプリケーション ポリシー拡張の編集]** ダイアログ ボックスで、**[OK]** を選択します。  

13. これにより、**[新しいテンプレートのプロパティ]** ダイアログ ボックスに、**アプリケーション ポリシー**の記述として **[サーバー認証]** と **[AMT プロビジョニング]** が表示されます。  

14. **[セキュリティ]** タブを選択し、**[Domain Admins]** および **[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

15. **[追加]** を選択し、帯域外サービス ポイントのサイト システムの役割用のコンピューター アカウントが含まれるセキュリティ グループの名前を入力して、**[OK]** を選択します。  

16. このグループに対して **[登録]** アクセス許可を選択し、**[読み取り]** アクセス許可をオフにしません。  

17. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

18. **[証明機関]** で、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

19. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr AMT プロビジョニング]** を選択し、**[OK]** を選択します。  

    > [!NOTE]  
    >  手順 18 または 19 を完了できない場合は、Windows Server 2008 Enterprise Edition を使用していることを確認してください。 Windows Server Standard Edition と Certificate Services を使用してもテンプレートは設定できますが、Windows Server 2008 Enterprise Edition を使用しない限り、更新した証明書テンプレートを使用して証明書を展開することはできません。  

20. **[証明機関]** を閉じないでください。  

    これで、内部 CA からの AMT プロビジョニング証明書を帯域外サービス ポイントのコンピューターにインストールする準備ができました。  

##### <a name="to-install-the-amt-provisioning-certificate"></a>AMT プロビジョニング証明書をインストールするには  

1. IIS を実行するメンバー サーバーを再起動して、構成されたアクセス許可で証明書テンプレートにアクセスできることを確認します。  

2. **[スタート]**、**[ファイル名を指定して実行]** の順に選択し、「**mmc.exe**」と入力します。 空のコンソールで、**[ファイル]** を選択し、次に **[スナップインの追加と削除]** を選択します。  

3. **[スナップインの追加と削除]** ダイアログ ボックスで、**[利用できるスナップイン]** リストから **[証明書]** を選択し、**[追加]** を選択します。  

4. **[証明書スナップイン]** ダイアログ ボックスで **[コンピューター アカウント]** を選択し、**[次へ]** を選択します。  

5. **[コンピューターの選択]** ダイアログ ボックスで、**[ローカル コンピューター: (このコンソールを実行しているコンピューター)]** が選択されていることを確認して、**[完了]** を選択します。  

6. **[スナップインの追加と削除]** ダイアログ ボックスで、**[OK]** を選択します。  

7. コンソールで、**[証明書 (ローカル コンピューター)]** を展開し、**[個人]** を選択します。  

8. **[証明書]** を右クリックして、**[すべてのタスク]** を選択し、次に **[新しい証明書の要求]** を選択します。  

9. **[開始する前に]** ページで、**[次へ]** を選択します。  

10. **[証明書の登録ポリシーの選択]** ページを表示する場合は、**[次へ]** を選択します。  

11. **[証明書の要求]** ページで、使用可能な証明書の一覧から **[AMT プロビジョニング]** を選択し、**[登録]** を選択します。  

12. **[証明書のインストール結果]** ページで、証明書がインストールされるのを待ち、**[完了]** を選択します。  

13. **[証明書 (ローカル コンピューター)]** を閉じます。  

    これで、内部 CA からの AMT プロビジョニング証明書がインストールされ、帯域外サービス ポイントのプロパティで選択できるようになりました。  

### <a name="create-and-issue-the-web-server-certificate-for-amt-based-computers"></a>AMT ベース コンピューター用の Web サーバー証明書を作成し発行する  
 AMT ベースのコンピューターの Web サーバー証明書を準備するには、次の手順に従います。  

##### <a name="to-create-and-issue-the-web-server-certificate-template"></a>Web サーバー証明書テンプレートを作成および発行するには  

1. AMT プロビジョニング中に System Center Configuration Manager が作成する AMT コンピューター アカウントを追加する、空のセキュリティ グループを作成します。  

2. 証明書サービスがインストールされているメンバー サーバーの証明機関のコンソールで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して **[証明書テンプレート]** コンソールを読み込みます。  

3. [結果] ウィンドウで、**[テンプレート表示名]** 列に **[Web サーバー]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

4. **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

   > [!IMPORTANT]  
   >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

5. **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr AMT Web サーバー証明書**」など、AMT コンピューターで帯域外管理に使用される Web 証明書を生成するテンプレート名を入力します。  

6. **[サブジェクト名]** タブで **[Active Directory の情報から構築する]** を選択し、**[サブジェクト名の形式]** で **[共通名]** を選択し、サブジェクトの別名の **[ユーザー プリンシパル名 (UPN)]** をオフにします。  

7. **[セキュリティ]** タブを選択し、**[Domain Admins]** および **[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

8. **[追加]** を選択し、AMT プロビジョニング用に作成したセキュリティ グループの名前を入力し、**[OK]** を選択します。  

9. このセキュリティ グループに対して、**[許可]** アクセス許可の **[読み取り]** と **[登録]** を選択します。  

10. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

11. **[証明機関]** コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

12. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr AMT Web サーバー証明書]** を選択し、**[OK]** を選択します。  

13. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

    これで、AMT Web サーバー テンプレートを使用して、Web サーバー証明書で AMT ベースのコンピューターを設定できるようになりました。 帯域外管理コンポーネントのプロパティで、この証明書テンプレートを選択します。  

### <a name="create-and-issue-the-client-authentication-certificates-for-8021x-amt-based-computers"></a>802.1X AMT ベース コンピューター用のクライアント認証証明書を作成し発行する  
 AMT ベースのコンピューターで 802.1X 認証の有線または無線ネットワーク向けのクライアント証明書を使用する場合、次の手順に従います。  

##### <a name="to-create-and-issue-the-client-authentication-certificate-template-on-the-ca"></a>CA でクライアント認証証明書テンプレートを作成および発行するには  

1. 証明書サービスがインストールされているメンバー サーバーの証明機関のコンソールで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して **[証明書テンプレート]** コンソールを読み込みます。  

2. 結果ウィンドウで、**[テンプレート表示名]** 列に **[ワークステーション認証]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

   > [!IMPORTANT]  
   >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

3. **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr AMT 802.1X クライアント認証証明書**」など、AMT コンピューターで帯域外管理に使用されるクライアント証明書を生成するテンプレート名を入力します。  

4. **[サブジェクト名]** タブで **[Active Directory の情報から構築する]** を選択し、**[サブジェクト名の形式]** で **[共通名]** を選択します。 サブジェクトの別名の **[DNS 名]** チェック ボックスをオフにして、**[ユーザー プリンシパル名 (UPN)]** を選択します。  

5. **[セキュリティ]** タブを選択し、**[Domain Admins]** および **[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

6. **[追加]** を選択し、帯域外管理コンポーネントのプロパティで指定する、AMT ベースのコンピューターのコンピューター アカウントが含まれるセキュリティ グループの名前を入力して、**[OK]** を選択します。  

7. このセキュリティ グループに対して、**[許可]** アクセス許可の **[読み取り]** と **[登録]** を選択します。  

8. **[OK]** を選択し、**[証明書テンプレート]** 管理コンソールの **[certtmpl - [証明書テンプレート]]** を閉じます。  

9. **[証明機関]** 管理コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

10. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr AMT 802.1X クライアント認証証明書]** を選択し、**[OK]** を選択します。  

11. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

    これで、AMT ベース コンピューターが 802.1X クライアント認証用に使用できるよう、クライアント認証証明書テンプレートを使用して証明書を発行する準備が整いました。 帯域外管理コンポーネントのプロパティで、この証明書テンプレートを選択します。  

##  <a name="BKMK_MacClient_SP1"></a> Mac コンピューター用のクライアント証明書の展開  

この証明書の展開では、1 つの手順登録証明書テンプレートを作成し、証明機関に発行します。  

###  <a name="BKMK_MacClient_CreatingIssuing"></a>Mac クライアント証明書テンプレートを作成して証明機関に発行する  
 この手順では、Mac コンピューターの System Center Configuration Manager 用にカスタム証明書テンプレートを作成し、その証明書テンプレートを証明機関に追加します。  

> [!NOTE]  
>  Windows クライアント コンピューター用または配布ポイント用に作成した証明書テンプレートがある場合でも、この手順では別の証明書テンプレートを使用します。  
>   
>  この証明書用に新しい証明書テンプレートを作成すると、証明書要求を権限があるユーザーのみに制限できます。  

##### <a name="to-create-and-issue-the-mac-client-certificate-template-on-the-certification-authority"></a>Mac クライアント証明書テンプレートを作成して証明機関に発行するには  

1. System Center Configuration Manager を使用して証明書を Mac コンピューターに登録する管理ユーザー用に、そのユーザー アカウントを含むセキュリティ グループを作成します。  

2. 証明機関コンソールを実行しているメンバー サーバーで **[証明書テンプレート]** を右クリックし、**[管理]** を選択して、証明書テンプレート管理コンソールを読み込みます。  

3. 結果ウィンドウで、**[テンプレート表示名]** 列に **[認証されたセッション]** と表示されているエントリを右クリックし、**[テンプレートの複製]** を選択します。  

4. **[テンプレートの複製]** ダイアログ ボックスで、**[Windows 2003 Server Enterprise Edition]** が選択されていることを確認してから、**[OK]** を選択します。  

   > [!IMPORTANT]  
   >  **[Windows 2008 Server Enterprise Edition]** を選択しないでください。  

5. **[新しいテンプレートのプロパティ]** ダイアログ ボックスの **[全般]** タブで、「**ConfigMgr Mac クライアント証明書**」など Mac クライアント証明書を生成するテンプレート名を入力します。  

6. **[サブジェクト名]** タブを選択して、**[Active Directory の情報から構築する]** が選択されていることを確認し、**[サブジェクト名の形式:]** で **[共通名]** を選択し、**[サブジェクトの別名にこの情報を含める]** の **[ユーザー プリンシパル名 (UPN)]** をオフにします。  

7. **[セキュリティ]** タブを選択し、**[Domain Admins]** および **[Enterprise Admins]** セキュリティ グループから **[登録]** アクセス許可を削除します。  

8. **[追加]** を選択し、手順 1 で作成したセキュリティ グループを指定して、**[OK]** を選択します。  

9. このグループに対して **[登録]** アクセス許可を選択し、**[読み取り]** アクセス許可をオフにしません。  

10. **[OK]** を選択して、**[証明書テンプレート]** コンソールを閉じます。  

11. [証明機関] コンソールで、**[証明書テンプレート]** を右クリックし、**[新規作成]** を選択して **[発行する証明書テンプレート]** を選択します。  

12. **[証明書テンプレートの選択]** ダイアログ ボックスで、先ほど作成した新しいテンプレート **[ConfigMgr Mac クライアント証明書]** を選択し、**[OK]** を選択します。  

13. これ以上証明書を作成して発行する必要がない場合は、**[証明機関]** を閉じます。  

    これで、登録するクライアント設定を構成するときに、Mac クライアント証明書テンプレートを選択できるようになりました。
