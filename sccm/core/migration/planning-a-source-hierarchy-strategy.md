---
title: "ソース階層の戦略 | Microsoft Docs"
description: "System Center Configuration Manager の移行ジョブを構成する前に、ソース階層を構成し、ソース サイトからデータを収集します。"
ms.custom: na
ms.date: 1/3/2017
ms.prod: configuration-manager
ms.reviewer: na
ms.suite: na
ms.technology: configmgr-other
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 4800a800-66c8-4c35-aebe-e413a23790c1
caps.latest.revision: "6"
caps.handback.revision: "0"
author: Brenduns
ms.author: brenduns
manager: angrobe
ms.openlocfilehash: 0619de32f859f512ee1c9f5a9c83ef8d04a256ca
ms.sourcegitcommit: 51fc48fb023f1e8d995c6c4eacfda7dbec4d0b2f
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 08/07/2017
---
# <a name="plan-a-source-hierarchy-strategy-in-system-center-configuration-manager"></a>System Center Configuration Manager でのソース階層戦略の計画

*適用対象: System Center Configuration Manager (Current Branch)*

System Center Configuration Manager 環境で移行ジョブを設定する前に、ソース階層を構成し、ソース階層内の少なくとも 1 つのソース サイトからデータを収集する必要があります。 ここでは、ソース階層の構成、ソース サイトの構成、および Configuration Manager でソース階層内のソース サイトからデータを収集する方法を決めるときに役立つ情報について説明します。 

##  <a name="BKMK_Source_Hierarchies"></a> ソース階層  
ソース階層とは、移行するデータを含む Configuration Manager 階層です。 移行を設定し、ソース階層を指定するときは、そのソース階層の最上位サイトを指定します。 このサイトはソース サイトとも呼ばれます。 ソース階層からデータを移行できる追加サイトも、ソース サイトと呼ばれます。  

-   Configuration Manager 2007 ソース階層からデータを移行する移行ジョブを設定する場合、ソース階層の 1 つまたは複数の特定のソース サイトからデータを移行するように構成します。  

-   System Center 2012 Configuration Manager 以降を実行するソース階層からデータを移行する移行ジョブを設定する場合、最上位サイトを指定するだけで済みます。  

一度に設定できるソース階層は 1 つのみです。  

-   新しいソース階層を設定すると、その階層が自動的に現在のソース階層になり、以前のソース階層が置き換えられます。  

-   ソース階層を設定するには、ソース階層の最上位サイトを指定し、ソース サイトの SMS プロバイダーとサイト データベースへの接続に使用する Configuration Manager の資格情報を指定する必要があります。  

-   Configuration Manager では、これらの資格情報を使用してデータ収集を実行し、ソース サイトからオブジェクトと配布ポイントに関する情報を取得します。  

-   データ収集処理の一環として、ソース階層の子サイトが識別されます。  

-   ソース階層が Configuration Manager 2007 階層の場合、各ソース サイト用の個別の資格情報を使用して、これらの追加サイトをソース サイトとして設定できます。  

複数のソース階層を連続して設定できますが、一度の移行でアクティブになるのは 1 つのソース階層のみです。  

-   現在のソース階層からの移行を完了する前に、追加のソース階層を設定すると、Configuration Manager によってアクティブな移行ジョブはすべて取り消され、現在のソース階層に関するスケジュール済みの移行ジョブはすべて延期されます。  

-   これで、新しく構成されたソース階層が現在のソース階層になり、元のソース階層は非アクティブになりました。  

-   続いて、新しいソース階層の接続資格情報、追加のソース サイト、移行ジョブを設定できます。  

**[移行データのクリーン アップ]** を使用したことがない状態で、非アクティブなソース階層を復元した場合、そのソース階層で以前に構成した移行ジョブを表示することができます。 ただし、その階層から移行を続行する前に、階層内の対応するソース サイトに接続できる資格情報を再構成し、完了しなかった移行ジョブを再スケジュールする必要があります。  

> [!CAUTION]  
>  複数のソース階層からデータを移行する場合、各追加ソース階層に固有のサイト コード セットを含める必要があります。  

ソース階層の構成の詳細については、「[System Center Configuration Manager に移行するためのソース階層とソース サイトの構成](../../core/migration/configuring-source-hierarchies-and-source-sites-for-migration.md)」をご覧ください。  

##  <a name="BKMK_Source_Sites"></a> ソース サイト  
 ソース サイトとは、移行するデータが格納されているソース階層内のサイトです。 ソース階層の最上位サイトは、常に最初のソース サイトとなります。 移行処理で新しいソース階層の最初のソース サイトからデータを収集すると、その階層内のその他のサイトに関する情報が検出されます。  

 最初のソース サイトでデータの収集が完了した後に実行する操作は、ソース階層の製品バージョンによって異なります。  

### <a name="source-sites-that-run-configuration-manager-2007-sp2"></a>Configuration Manager 2007 SP2 を実行するソース サイト  
 Configuration Manager 2007 SP2 階層の最初のソース サイトからデータを収集したら、移行ジョブを作成する前に追加ソース サイトを設定する必要はありません。 ただし、追加サイトからデータを移行する前に、追加サイトをソース サイトとして設定する必要があります。また、System Center Configuration Manager がそれらのサイトからデータを正常に収集する必要があります。  

 追加サイトからデータを収集するには、各サイトをソース サイトとして個別に設定します。 この場合、各ソース サイトの SMS プロバイダーとサイト データに接続できる System Center Configuration Manager の資格情報を指定する必要があります。 ソース サイトの資格情報を設定すると、そのサイトのデータ収集プロセスが開始されます。  

 Configuration Manager 2007 SP2 ソース階層で追加ソース サイトを設定するときは、上から順番にソース サイトを設定し、最後に最下位のサイトを設定します。 いつでも階層のいずれかの分岐でソース サイトを設定できますが、子サイトをソース サイトとして設定するには、先にその親サイトをソース サイトとして設定する必要があります。  

> [!NOTE]  
>  Configuration Manager 2007 SP2 階層内のプライマリ サイトのみが移行対象としてサポートされます。  

### <a name="source-sites-that-run-system-center-2012-configuration-manager-or-later"></a>System Center 2012 Configuration Manager 以降を実行しているソース サイト  
 System Center 2012 Configuration Manager 以降の階層の最初のソース サイトからデータを収集した後、そのソース階層から追加のソース サイトを設定する必要はありません。 これは、Configuration Manager 2007 と異なり、Configuration Manager のこれらのバージョンが共有データベースを使用するためです。共有データベースによって、最初のソース サイトから使用できるすべてのオブジェクトを識別し、移行することができます。  

 データを収集するためのアクセス アカウントを設定する場合、必要に応じて、**ソース サイトの SMS プロバイダー アカウント** アクセス権を、ソース階層内の複数のコンピューターに付与します。 ソース サイトが各コンピューターで SMS プロバイダーの複数のインスタンスをサポートしている場合に、この操作が必要になることがあります。 データ収集が始まると、移行先階層の最上位サイトはソース階層内の最上位サイトに接続し、そのサイトの SMS プロバイダーの場所を識別します。 SMS プロバイダーの最初のインスタンスのみが識別されます。 データ収集プロセスで、識別された場所の SMS プロバイダーにアクセスできない場合、プロセスは失敗し、そのサイトで SMS プロバイダーのインスタンスを実行する他のコンピューターには接続を試行しません。  

##  <a name="BKMK_Data_Gathering"></a> データ収集  
 ソース階層を指定する操作、ソース階層内の各追加ソース サイトの資格情報を設定する操作、またはソース サイトの配布ポイントを共有する操作を行うと、Configuration Manager でソース サイトからのデータ収集が直ちに開始されます。  

 その後、データ収集プロセスは単純なスケジュールを繰り返し、ソース サイト内で変更されたデータを継続的に同期します。 既定では、このプロセスは 4 時間ごとに繰り返し実行されます。 このスケジュールを変更するには、ソース サイトの **[プロパティ]** を編集します。 初期のデータ収集プロセスでは、Configuration Manager データベース内のオブジェクトをすべて確認する必要があるため、時間がかかることがあります。 後続するデータ収集プロセスではデータの変更のみが識別されるため、所要時間は短くなります。  

 データを収集するために、移行先階層の最上位サイトは SMS プロバイダーとソース サイトのサイト データベースに接続し、オブジェクトと配布ポイントのリストを取得します。 これらの接続はソース サイト アクセス アカウントを使用します。 データ収集に必要な構成の詳細については、「 [Prerequisites for migration in System Center Configuration Manager](../../core/migration/prerequisites-for-migration.md)」(System Center Configuration Manager の移行のための前提条件) を参照してください。  

 Configuration Manager コンソールで **[今すぐデータ収集]** および **[データ収集の停止]** を使用して、データ収集プロセスの開始と停止を行うことができます。  

 何らかの理由でソース サイトの **[データ収集の停止]** を使用した後に、そのサイトから再びデータを収集する場合は、そのサイトの資格情報を再構成する必要があります。 ソース サイトを再構成するまでは、そのサイトの新規オブジェクトや以前に移行済みのオブジェクトに加えられた変更を Configuration Manager で識別することはできません。  

> [!NOTE]  
>  スタンドアロンのプライマリ サイトを中央管理サイトがある階層に拡張するには、あらかじめすべてのデータ収集を停止する必要があります。 サイトの拡張が完了したら、データ収集を再構成できます。  

### <a name="gather-data-now"></a>コンソールで   
 サイトの初期データの収集プロセスの実行後、このプロセスが繰り返し実行され、前回のデータ収集時以降に更新されたオブジェクトを識別します。 Configuration Manager コンソールで [**今すぐデータ収集** ] アクションを使用して、プロセスをすぐに開始し、次のサイクルの開始時刻をリセットすることもできます。  

 ソース サイトのデータ収集プロセスが正常に完了したら、そのソース サイトの配布ポイントを共有して、サイトのデータを移行する移行ジョブを構成できます。 データ収集は繰り返して実行される移行プロセスで、ソース階層を変更するか、**[データ収集の停止]** を使用してサイトのデータ収集プロセスを終了するまで継続されます。  

### <a name="stop-gathering-data"></a>] および [  
 Configuration Manager がサイトから新規または変更オブジェクトを識別する必要がなくなったら、**[データ収集の停止]** を使用して、ソース サイトのデータ収集プロセスを終了できます。 データ収集を停止すると、Configuration Manager は、移行済みコンテンツの場所として、そのソース階層の共有配布ポイントを移行先階層のクライアントに提示しなくなります。  

 各ソース サイトからのデータ収集を停止するには、最下位のソースサイトで **[データ収集の停止]** を実行してから、親サイトごとにそのプロセスを繰り返し実行する必要があります。 ソース階層の最上位サイトは、データ収集を停止する最後のサイトにする必要があります。 親サイトでデータ収集の停止操作を実行する前に、各子サイトでデータ収集を停止する必要があります。 通常、移行処理を完了する準備ができた時点でデータ収集を停止します。  

 ソース サイトのデータ収集の停止後も、オブジェクトとコレクションに関してそのサイトから収集済みの情報は、新しい移行ジョブの設定時に引き続き使用可能な状態のままになります。 ただし、新しいオブジェクトやコレクションは表示されず、既存のオブジェクトに加えられた変更も表示されません。 ソース サイトを再構成してデータ収集を再び開始すると、以前に移行済みのオブジェクトに関する情報とステータスが表示されます。  
